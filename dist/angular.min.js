angular.module("allex_applib",[]),function(t,e,i){"use strict";function n(){s.call(this)}function o(t,e,n){Array.prototype.push.apply(t,i.ANGULAR_REQUIREMENTS.get(n))}function r(t,e){if(t)for(var n=0;n<t.length;n++)i.ANGULAR_REQUIREMENTS.get(t[n].type)&&!e.get(t[n].type)&&e.add(t[n].type,!0),t[n].options&&t[n].options.elements&&r(t[n].options.elements,e)}var a=ALLEX.lib,l=e.registerPreprocessor,s=e.BasicProcessor,p=new a.Map;i.ANGULAR_REQUIREMENTS=p,a.inherit(n,s),n.prototype.destroy=function(){s.prototype.destroy.call(this)},n.prototype.process=function(t){if(!t)throw new Error("No APP descriptor");t.resources||(t.resources=[]);var e,i=t.resources,n=null,l=0;for(e=0;e<i.length;e++)if("AngularBootstrapper"===i[e].type){if(l>0)throw new Error("Multiple instances of AngularBootstrapper found, only one allowed");n=i[e],l++}n||(n={type:"AngularBootstrapper",name:"AngularBootstrapper",options:{angular_dependencies:[]}},i.push(n)),n.options.angular_dependencies||(n.options.angular_dependencies=[]);var s=new a.Map;r(t.elements,s),s.traverse(o.bind(null,n.options.angular_dependencies)),n.options.angular_dependencies=a.arryOperations.unique(n.options.angular_dependencies)},l("AngularPreProcessor",n)}(0,ALLEX.WEB_COMPONENTS.allex_applib,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent),angular.module("allex_applib",[]),function(t,e,i,n){"use strict";function o(t){l.call(this,t),this.raise=null,this._getResource=null}function r(t){o.call(this,t),this.data=null}var a=ALLEX.lib,l=a.BasicAngularController;a.inherit(o,l),o.prototype.__cleanUp=function(){this.raise=null,this._getResource=null,l.prototype.__cleanUp.call(this)},o.prototype.getResource=function(t){return this._getResource?this._getResource(t):void 0},o.prototype.elementReady=function(t){var e=t.data("allex_element");if(!e)throw new Error("Missing allex element ...");e.set("$scopectrl",this)},o.prototype.raiseEvent=function(t,e){this.raise(t,e)},a.inherit(r,o),r.prototype.__cleanUp=function(){this.data=null,o.prototype.__cleanUp.call(this)},r.prototype.set_data=function(t){return this.data!==t&&(this.data=t,!0)},e.elements.AngularDataAwareController=r,e.elements.BasicAngularElementController=o}(0,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n){"use strict";function o(t,e){a.call(this,t,e),l.call(this),this._addHook("onAngularReady"),this.$scopectrl=null,e&&e.initialData&&this.set("data",e.initialData)}var r=ALLEX.lib,a=(r.BasicAngularController,e.elements.WebElement),l=e.mixins.DataElementMixIn;r.q;r.inherit(o,a),o.prototype.__cleanUp=function(){this.$scopectrl=null,l.prototype.__cleanUp.call(this),a.prototype.__cleanUp.call(this)},o.prototype.updateHashField=function(t,e){var i={};i[t]=e,this.set("data",r.extend({},this.get("data"),i))},o.prototype.updateArrayElement=function(t,e){var i=this.get("data"),n=i?i.slice():[];n[t]=e,this.set("data",n)},o.prototype.getArrayDataCopy=function(){var t=this.get("data");return t?t.slice():null},o.prototype.getHashDataCopy=function(){return r.extend({},this.get("data"))},o.prototype.set_$scopectrl=function(t){this.$scopectrl=t,this._onScope(t),this._setRaise(),this.fireHook("onAngularReady",[this]),this.$scopectrl.set("data",this.get("data"))},o.prototype.isScopeReady=function(){return!!this.$scopectrl},o.prototype.executeOnScopeIfReady=function(t,e){if(this.$scopectrl){var i=r.readPropertyFromDotDelimitedString(this.$scopectrl,t,!0);return i.val.apply(i.ctx,e)}},o.prototype._setRaise=function(){this.$scopectrl.set("raise",this.raiseEvent.bind(this)),this.$scopectrl.set("_getResource",this.getResource.bind(this))},o.prototype.set_data=function(t){var e=l.prototype.set_data.call(this,t);return l.prototype.hasDataChanged.call(this,e)&&this.executeOnScopeIfReady("set",["data",this.data]),e},o.prototype.getMeAsElement=function(){return this.$element},o.prototype.initialize=function(){a.prototype.initialize.call(this),this.$element.data("allex_element",this),this.attachHook("onAngularReady",this.getConfigVal("onAngularReady"))},o.prototype.$apply=function(){this.$scopectrl&&this.$scopectrl.$apply()},o.prototype._onScope=r.dummyFunc,e.elements.BasicAngularElement=o}(0,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n){"use strict";function o(t,e){s.call(this,t,e)}function r(t,e){s.call(this,t,e)}var a=ALLEX.lib,l=e.elements.AngularDataAwareController,s=e.elements.BasicAngularElement;a.q;a.inherit(o,s),o.prototype.__cleanUp=function(){s.prototype.__cleanUp.call(this)},o.prototype.initialize=function(){s.prototype.initialize.call(this),this.$element.attr("data-allex-angular-element","")},e.elements.AngularElement=o,i.registerElementType("AngularElement",o),n.controller("allexAngularElementController",["$scope",function(t){new l(t)}]),n.directive("allexAngularElement",[function(){return{restrict:"A",scope:!0,controller:"allexAngularElementController",link:function(t,e,i){t._ctrl.elementReady(e)}}}]),a.inherit(r,s),r.prototype.set_data=function(t){var e,i,n=s.prototype.set_data.call(this,t);if(!1!==n&&(e=this.__parent.$scopectrl,i=this.$element.attr("name"),e&&i))if(e.data)e.data[i]=t;else{var o={};o[i]=t,e.set("data",o)}return n},e.elements.AngularFormElement=r,i.registerElementType("AngularFormElement",r)}(0,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n){"use strict";function o(t,e,i){"regex"===i&&(f.isString(e)&&(t[i]=new RegExp(e)),e&&"object"==typeof e&&"string"in e&&"flags"in e&&f.isString(e.string)&&(t[i]=new RegExp(e.string,e.flags)))}function r(t,e){"object"==typeof t&&(f.traverseShallow(t,o.bind(null,t)),t=null)}function a(t){t&&(f.traverseShallow(t,r),t=null)}function l(t,e){_.call(this,t,e),this.$form=null,this.submit=new f.HookCollection,this.partialSubmit=new f.HookCollection,this.valid=null,this._valid_l=null,this.validfields={},this._validfields_l={},this._default_values={},this.change=new f.HookCollection,this.initial=e?e.initial:null,this.ftion_status=null,this.progress=null,this.array_keys=e?e.array_keys:null,a(this.getConfigVal("validation"))}function s(t,e,i){i in t||(t[i]=e)}function p(t){g.call(this,t),this.data={},this.valid=!1,this._watcher=null,this.validation=null,this.confirmationfields=null,this._onChange=null,this.config=null,this.progress=null,this.ftion_status=null,this.disabled=!1}function c(t){m.call(this,t)}function u(t){m.call(this,t)}function d(t){return t.ftion}function h(t){m.call(this,t)}var f=ALLEX.lib,g=e.elements.BasicAngularElementController,_=e.elements.BasicAngularElement,m=(f.q,i.BasicModifier),y=/\[\]$/;f.inherit(l,_),l.prototype.__cleanUp=function(){this.progress=null,this.ftion_status=null,this.array_keys=null,this.initial=null,this.change.destroy(),this.change=null,this._default_values=null,f.traverseShallow(this._validfields_l,this._unlisten.bind(this)),this.validfields=null,this.$form=null,this._valid_l&&this._valid_l.destroy(),this._valid_l=null,this.partialSubmit.destroy(),this.partialSubmit=null,this.submit.destroy(),this.submit=null,this.valid=!1,_.prototype.__cleanUp.call(this)},l.prototype.set_ftion_status=function(t){var e=!1;t&&(this.ftion_status?e=this.ftion_status.working&&t.result:t.result&&(e=!0)),this.ftion_status=t;var i=this.getConfigVal("closeOnSuccess");console.log("was active?",e,i),this.isScopeReady()&&e&&((!0===i||f.isNumber(i))&&this.doCloseOnSuccess(i),this.getConfigVal("clearOnSuccess")&&this.set("data",null)),this.executeOnScopeIfReady("set",["ftion_status",t])},l.prototype.doCloseOnSuccess=function(t){!0===t&&(t=0),this.executeOnScopeIfReady("set",["disabled",!1]),f.runNext(this.set.bind(this,"actual",!1),t)},l.prototype.set_progress=function(t){this.progress=t,this.executeOnScopeIfReady("set",["progress",t])},l.prototype._unlisten=function(t){f.isFunction(t)&&t()},l.prototype.set_actual=function(t){_.prototype.set_actual.call(this,t),this.set("ftion_status",null),this.set("progress",null),this.executeOnScopeIfReady("set",["disabled",!t])},l.prototype.initialize=function(){_.prototype.initialize.call(this),this.$element.attr({"data-allex-angular-form-logic":""}),this.$form=this.$element.is("form")?this.$element:this.$element.find("form"),this.$form.attr({name:this.get("id"),novalidate:""}),this.$form.removeAttr("action"),this.$form.find("[name]").toArray().forEach(this._prepareForAngular.bind(this)),this.appendHiddenFields(this.getConfigVal("hidden_fields"))},l.prototype._prepareForAngular=function(t){var e=jQuery(t),i=e.attr("name"),n=this.getModelName(i);if(n){var o=e.attr("data-ng-readonly"),r=o&&o.length?"("+o+") ||":"";r+="(_ctrl.disabled || _ctrl.progress)",e.attr({"data-allex-angular-validate":"_ctrl.validation."+n,"data-ng-change":"_ctrl.onChange('"+n+"', _ctrl.data."+n+")"}),e.attr("readonly")||e.attr("data-ng-readonly",r),e.attr("data-ng-model")||e.attr("ng-model")||e.attr("data-ng-model","_ctrl.data."+n),this._validfields_l[n]=null}else console.warn("There is no name for input field ",e.attr("id"),"form logic",this.get("id"))},l.prototype.appendHiddenFields=function(t){t&&t.length&&t.forEach(this._appendHiddenField.bind(this))},l.prototype._appendHiddenField=function(t){var e=f.isString(t)?t:t.name,i={name:e,type:"hidden"};!f.isString(t)&&(i.required=t.required?"":void 0,"value"in t&&(this._default_values[e]=t.value)),this.findByFieldName(e).remove();var n=$("<input>").attr(i);this._prepareForAngular(n),this.$form.append(n)},l.prototype.findByFieldName=function(t){return this.$form.find('[name="'+t+'"]')},l.prototype.toArray=function(t){return f.hashToArray(t,this.get("data"))},l.prototype.fireSubmit=function(){this.submit.fire(this.array_keys?this.toArray(this.array_keys):this.get("data"))},l.prototype.firePartialSubmit=function(t){this.isFieldValid(t)&&this.partialSubmit.fire(t,this.data?this.data[t]:null)},l.prototype.set_data=function(t){return f.traverseShallow(this._default_values,s.bind(null,t)),_.prototype.set_data.call(this,t)},l.prototype.get_data=function(){return this.$scopectrl?this.$scopectrl.get("data"):this.data},l.prototype.getModelName=function(t){var e=t;return t.match(y)&&(e=t.replace(y,"")),e},l.prototype.revalidate=function(){if(this.$scopectrl){var t=this.$scopectrl.scope[this.id];if(t)for(var e in this.validfields)t[e]&&t[e].$validate()}},l.prototype._onScope=function(t){this._valid_l=t.attachListener("valid",this.set.bind(this,"valid")),t.set("validation",this.getConfigVal("validation")),t.set("confirmationfields",this.getConfigVal("confirmationfields")),t.set("_onChange",this._onChanged.bind(this)),f.traverseShallow(this._validfields_l,this._watchForValid.bind(this,t.scope,this.$form.attr("name"))),t.set("config",this.getConfigVal("form")),t.set("progress",this.get("progress")),t.set("ftion_status",this.get("ftion_status")),t.set("disabled",!this.get("actual")),this.initial&&f.runNext(this._setInitial.bind(this))},l.prototype._onChanged=function(t,e,i){this.changed.fire("data",t),this.change.fire(e,i)},l.prototype._setInitial=function(t){this.set("data",f.extend({},this.initial,t));for(var e in this.initial)this.change.fire(e,this.initial[e])},l.prototype.resetElement=function(t){_.prototype.resetElement.call(this,t),this.resetForm(t)},l.prototype.resetForm=function(t){this._setInitial(t)},l.prototype._watchForValid=function(t,e,i,n){this._validfields_l[n]=t.$watch("_ctrl.data."+n,this._updateError.bind(this,t,e,n))},l.prototype._updateError=function(t,e,i){var n=f.extend({},this.validfields);t[e][i]?(n[i]=!Object.keys(t[e][i].$error).length,this.set("validfields",n)):console.warn("no "+i+" in validator")},l.prototype.isFieldValid=function(t){return!(!this.$scopectrl||!this.$scopectrl.scope[this.get("id")])&&this.$scopectrl.scope[this.get("id")][t].$valid},l.prototype.set_valid=function(t){return this.valid!==t&&(this.valid=t,!0)},l.prototype.empty=function(){this.set("data",{})},l.prototype.setInputEnabled=function(t,e){var i=this.$form.find('[name="'+t+'"]');i.attr("data-ng-disabled",e?"false":"true"),e?i.removeAttr("disabled"):i.attr("disabled","disabled"),this.executeOnScopeIfReady("$apply")},l.prototype.disableInput=function(t){this.setInputEnabled(t,!1)},l.prototype.enableInput=function(t){this.setInputEnabled(t,!0)},l.prototype.isFormValid=function(){for(var t in this.validfields)if(!this.isFieldValid(t))return!1;return!0},e.elements.AngularFormLogic=l,i.registerElementType("AngularFormLogic",l),f.inherit(p,g),p.prototype.__cleanUp=function(){this.disabled=null,this.ftion_status=null,this.progress=null,this.confirmationfields=null,this.validation=null,this._watcher&&this._watcher(),this._watcher=null,this.data=null,this.valid=null,this._onChange=null,this.config=null,g.prototype.__cleanUp.call(this)},p.prototype.onChange=function(t,e){f.isFunction(this._onChange)&&this._onChange(this.data,t,e)},p.prototype.elementReady=function(t){g.prototype.elementReady.call(this,t),this._watcher=this.scope.$watch(t.attr("id")+".$valid",this.set.bind(this,"valid"))},p.prototype.set_valid=function(t){return this.valid!==t&&(this.valid=t||null,!0)},p.prototype.validate=function(t,e,i){var n=this.validation,o=this.confirmationfields;return!(f.isVal(e)&&o&&"object"==typeof o&&t in o&&e!==this.data[o[t]])&&(!n||(!n[t]||!!this.validateJSON(n[t].json_schema,e)&&(!!this.validateRegExp(n[t].regex,e)&&this.validateFunction(n[t].custom,e))))},p.prototype.validateJSON=function(t,e){return!t||!f.jsonschema.validate(e,t).errors.length},p.prototype.validateRegExp=function(t,e){return!t||(!(t instanceof RegExp)||t.test(e))},p.prototype.validateFunction=function(t,e){return!f.isFunction(t)||t(e,this.data)},n.controller("allexAngularFormLogicController",["$scope",function(t){new p(t)}]),n.directive("allexAngularFormLogic",function(){return{restrict:"A",scope:!0,controller:"allexAngularFormLogicController",link:function(t,e,i){t._ctrl.elementReady(e)}}}),f.inherit(c,m),c.prototype.destroy=function(){m.prototype.destroy.call(this)},c.prototype.doProcess=function(t,e,i,n,o){var r=t+"Submit",a="."+r;switch(e.elements.push({name:r,type:"WebElement"}),i.push({source:a+".$element!click",target:".>fireSubmit"},{source:".:valid",target:"$element.#"+r+":attr.disabled",filter:this._decideDisabled.bind(this)}),this.getConfigVal("actual")){case"always":i.push({source:".:actual",target:a+":actual"});break;default:case"valid":n.push({triggers:[".:valid, .:actual"],references:a+", .",handler:function(t,e){t.set("actual",e.get("valid")&&e.get("actual"))}})}},c.prototype._decideDisabled=function(t){return t?void 0:"disabled"},c.ALLOWED_ON=["AngularFormLogic"],c.prototype.DEFAULT_CONFIG=function(){return{actualon:"valid"}},i.registerModifier("AngularFormLogic.submit",c),f.inherit(u,m),u.prototype.destroy=function(){m.prototype.destroy.call(this)},u.prototype.doProcess=function(t,e,i,n,o){var r=this.getConfigVal("form"),a=this.getConfigVal("cbs");if(!r)throw new Error("No form in SubmissionModifier");if(!a)throw new Error("No cbs in SubmissionModifier");n.push({triggers:r+"!submit",references:[r].concat(a.map(d)).join(","),handler:this._onSubmit.bind(this,a)});for(var l=r+":progress",s=r+":ftion_status",p=0;p<a.length;p++)i.push({source:a[p].ftion,target:l,filter:this._processProgress.bind(this)},{source:a[p].ftion,target:s,filter:this._processStatus.bind(this)})},u.prototype._onSubmit=function(t,e){for(var i=t.length,n=Array.prototype.slice.call(arguments,2,t.length+2),o=arguments[2+t.length],r=0;r<i;r++)t[r].conditional&&!t[r].conditional(o)||n[r](f.isFunction(t[r].filter)?t[r].filter(o,e):[o])},u.prototype._processFilter=function(t){},u.prototype._processProgress=function(t){return t&&t.working&&t.progress},u.prototype._processStatus=function(t){return!t||t.working?null:t.error?{error:t.error}:t.result?{result:t.result}:null},u.prototype.DEFAULT_CONFIG=function(){return null},i.registerModifier("SubmissionModifier",u),f.inherit(h,m),h.prototype.destroy=function(){m.prototype.destroy.call(this)},h.ALLOWED_ON=["AngularFormLogic"],h.prototype._prepareItem=function(t,e,i,n,o,r){var a=r.path,l=r.field;if(!l)throw new Error("No field given in FieldBindingModifier "+t);a||(a=t+"_partialSubmit_"+l),i.push({source:".:actual",target:a+":actual"}),n.push({triggers:[".:actual",".:data"],references:"., "+a,handler:this._decide.bind(this,l)},{triggers:a+".$element!click",references:".",handler:this._onTrigger.bind(this,l)})},h.prototype.doProcess=function(t,e,i,n,o){var r=this.getConfigVal("list");if(f.isArray(r))r.forEach(this._prepareItem.bind(this,t,e,i,n,o));else{var a=this.getConfigVal("path"),l=this.getConfigVal("field");l&&this._prepareItem(t,e,i,n,o,{path:a,field:l})}},h.prototype._decide=function(t,e,i){i.$element.attr("disabled",e.isFieldValid(t)?null:"disabled")},h.prototype._onTrigger=function(t,e){e.firePartialSubmit(t)},h.prototype.DEFAULT_CONFIG=function(){return null},i.registerModifier("AngularFormLogic.bindField",h)}(0,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n){"use strict";function o(t,e){"headerCellFilter"in e||(e.headerCellFilter=t)}function r(t){var e=h.extend({},t.actions,{field:"-",enableFiltering:!1});return o(t.defaultHeaderCellFilter,e),e}function a(t,e){g.call(this,t,e),this.afterEdit=new h.HookCollection,this.config.grid=h.extend({},a.DEFAULT_GRID_CONFIG,this.config.grid),this.config.grid.data||(this.config.grid.data="_ctrl.data"),this.config.defaultHeaderCellFilter&&this.config.grid.columnDefs.forEach(o.bind(null,this.config.defaultHeaderCellFilter))}function l(t){return p("enableCellEdit",t)}function s(t){return p("enableColumnResizing",t)}function p(t,e){if(e[t])return!0}function c(t,e){t[e]&&"#"===t[e].charAt(0)&&(t[e]=jQuery("#references > "+t[e]).html())}function u(t,e){e.type&&(e.type=t[e.type]),e.condition&&h.isString(e.condition)&&(e.condition=t[e.condition])}function d(t,e,i){f.call(this,t),_.call(this),this.uiGridConstants=i,this.data=[],this.gridOptions=null,this.api=null,this._listenToEditEvents=!1}var h=ALLEX.lib,f=e.elements.AngularDataAwareController,g=(e.mixins.DataElementMixIn,e.elements.BasicAngularElement),_=h.CBMapable;h.q;h.inherit(a,g),a.prototype.__cleanUp=function(){this.afterEdit.destroy(),this.afterEdit=null,g.prototype.__cleanUp.call(this)},a.prototype._replacePossibleTemplates=function(t){c(t,"cellTemplate"),c(t,"filterHeaderTemplate")},a.prototype.initialize=function(){g.prototype.initialize.call(this);var t=this.config.grid.enableCellEdit||h.traverseConditionally(this.getColumnDefs(),l),e=this.config.grid.enableColumnResizing||h.traverseConditionally(this.getColumnDefs(),s),i=this.getConfigVal("noDataContent"),n=this.getConfigVal("grid.data");this.getColumnDefs().forEach(this._replacePossibleTemplates.bind(this));var o=$('<div class="table_container" ng-show="'+n+'.length"></div>'),a=$('<div class="no_data_container" ng-show = "!'+n+'.length"></div>');o.attr("ui-grid","_ctrl.gridOptions"),o.attr("ui-grid-auto-resize",""),t&&o.attr("ui-grid-edit",""),e&&o.attr("ui-grid-resize-columns",""),h.isString(i)&&("#"===i[0]?a.append($("#references > "+i).html()):a.append(i)),!0===i&&a.append(this.findDomReference("nodata").html()),o.addClass("grid"),this.$element.attr({"data-allex-angular-data-table":""}),this.$element.append(o),i&&this.$element.append(a);var p=this.findDomReference("actions"),c=null,u=this.getConfigVal("actionsWrapper")?$(this.getConfigVal("actionsWrapper")):null,d=u?$(u):null;if(c=d?p.length?d.append(p):null:p.length?p:null){var f=h.arryOperations.findElementWithProperty(this.config.grid.columnDefs,"field","-"),_={displayName:c.attr("data-title")||"Actions",cellTemplate:c.html()};f?(f.displayName||(f.displayName=_.displayName),f.cellTemplate||(f.cellTemplate=_.cellTemplate)):this.config.grid.columnDefs.unshift(h.extend({},_,r(this.config)))}},a.prototype.getApi=function(){return this.$scopectrl?this.$scopectrl.api:null},a.prototype._onScope=function(t){var e={appendNewRow:this.appendNewRow.bind(this)};""===this.$element.find(".grid.table_container").attr("ui-grid-edit")&&(e.afterEdit=this.afterEdit.fire.bind(this.afterEdit)),t.set("_cbmap",e),this.config.grid.enableHorizontalScrollbar=!1===this.config.grid.enableHorizontalScrollbar?t.uiGridConstants.scrollbars.NEVER:t.uiGridConstants.scrollbars.ALWAYS,this.config.grid.enableVerticalScrollbar=!1===this.config.grid.enableVerticalScrollbar?t.uiGridConstants.scrollbars.NEVER:t.uiGridConstants.scrollbars.ALWAYS,this.config.grid.columnDefs.forEach(this._processFilters.bind(this,t)),t.set("gridOptions",this.config.grid)},a.prototype._processFilters=function(t,e,i){var n=t.uiGridConstants.filter;if(e.filter)return u(n,e.filter),e.filters=[e.filter],void(e.filter=null);e.filters&&e.filters.forEach(u.bind(null,n))},a.prototype.set_data=function(t){!1!==g.prototype.set_data.call(this,t)&&(this.executeOnScopeIfReady("set",["data",t]),this.executeOnScopeIfReady("api.core.refresh"))},a.prototype.getCleanData=function(){angular.copy(this.getTableData())},a.prototype.appendNewRow=function(t){var e={};this.getConfigVal("config.bSetNewRowProps");var i=this.getConfigVal("appendNewRow");return i?i(this,t,e):e},a.prototype.get_rows=function(){return this.$scopectrl.api?this.$scopectrl.api.grid.rows:null},a.prototype.getElement=function(t){return"$element"===t?this.$element:g.prototype.getElement.call(this,t)},a.prototype.set_row_count=function(t){return this.executeOnScopeIfReady("set",["row_count",t])},a.prototype.get_row_count=function(){return this.executeOnScopeIfReady("get",["row_count"])},a.prototype.getColumnDefs=function(){return this.getConfigVal("grid.columnDefs")},a.prototype.$apply=function(){g.prototype.$apply.call(this),this.executeOnScopeIfReady("api.core.refresh")},a.prototype.removeAllColumns=function(){if(this.isScopeReady())this.config.grid.columnDefs.splice(0,this.config.grid.columnDefs.length),this.refreshGrid();else{var t=this.getColumnDefs();t.splice(0,t.length)}},a.prototype.appendColumn=function(t){this.isScopeReady()?(this.config.grid.columnDefs.push(t),this.refreshGrid()):this.getColumnDefs().push(t)},a.prototype.set_column_defs=function(t){if(this.isScopeReady())this.config.grid.columnDefs=t,this.refreshGrid();else{var e=this.getColumnDefs();e.splice(0,e.length),Array.prototype.push.apply(e,t)}},a.prototype.updateColumnDef=function(t,e){if(this.isScopeReady())return this.getColumnDef(t).colDef=e,void this.refreshGrid();var i=this.getColumnDef(t),n=this.getColumnDefs(),o=n.indexOf(i);if(o<0)throw new Error("No column definition for name ",t);n[o]=e},a.prototype.getColumnDef=function(t){if(this.isScopeReady()&&this.getApi().grid.columns.length){var e=this.getApi().grid.getColumn(t);return e?e.colDef:null}return h.arryOperations.findElementWithProperty(this.getColumnDefs(),"name",t)},a.prototype.refreshGrid=function(){this.executeOnScopeIfReady("api.grid.refresh")},a.prototype.getTableData=function(){return this.executeOnScopeIfReady("getActualData")},a.prototype.getRowIndexUponEntity=function(t){for(var e=this.getApi().grid.rows,i=0;i<e.length;i++)if(e[i].entity.$$hashKey===t.$$hashKey)return i;return-1},a.prototype.removeRow=function(t){var e=this.getTableData(),i=this.getRowIndexUponEntity(t);i<0||(e.splice(i,1),this.refreshGrid())},a.isSpecialColumnName=function(t){return"-"===t},a.DEFAULT_GRID_CONFIG=null,e.elements.AngularDataTable=a,i.registerElementType("AngularDataTable",a),e.ANGULAR_REQUIREMENTS.add("AngularDataTable",["ui.grid","ui.grid.edit","ui.grid.autoResize","ui.grid.resizeColumns"]),h.inherit(d,f),_.addMethods(d),d.prototype.__cleanUp=function(){this.uiGridConstants=null,this.rowCountChanged.destroy(),this.rowCountChanged=null,this.editDone=new h.HookCollection,this.gridOptions=null,this.data=null,this.api=null,_.prototype.__cleanUp.call(this),f.prototype.__cleanUp.call(this)},d.prototype.set_gridOptions=function(t){return this.gridOptions!==t&&(this.api=null,this.gridOptions=t,!this.gridOptions||void(this.gridOptions.onRegisterApi=this.set.bind(this,"api")))},d.prototype.set_api=function(t){this.api!==t&&(this.api=t,this._cbmap&&this._cbmap.afterEdit&&this.api.edit.on.afterCellEdit(this.scope,this._onAfterEdit.bind(this)))},d.prototype._onAfterEdit=function(t,e,i,n){n!==i&&this.call_cb("afterEdit",[{newValue:i,oldValue:n,row:t,field:e.name}])},d.prototype.set_row_count=function(t){var e=this.getActualData();if(!h.isArray(e))return!1;var i=e.length,n=null;if(t===i)return!1;if(t<i)e.splice(t,i-t);else for(;e.length<t;)n=this.call_cb("appendNewRow",[e.length]),e.push(n);return!0},d.prototype.getActualData=function(){return h.isString(this.gridOptions.data)?this.scope.$eval(this.gridOptions.data):this.gridOptions.data},d.prototype.get_row_count=function(){return this.getActualData().length},n.controller("allexAngularDataTableController",["$scope","$parse","uiGridConstants",function(t,e,i){new d(t,e,i)}]),n.directive("allexAngularDataTable",[function(){return{restrict:"A",scope:!0,controller:"allexAngularDataTableController",link:function(t,e,i){t._ctrl.elementReady(e)}}}])}(0,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n){"use strict";function o(t,e){c.call(this,t,e),this.data=null,this._temp_cache=null}function r(t,e,i){t.$scopectrl.$templateCache.put("#references #"+i,e)}function a(t,e){p.call(this,t),this.$templateCache=e,this.content_container=null,this.html=null,this.data=null,this.title=null,this.notificationClass=null}function l(t){u.call(this,t)}var s=ALLEX.lib,p=e.elements.BasicAngularElementController,c=e.elements.BasicAngularElement,u=(s.q,i.BasicModifier);s.inherit(o,c),o.prototype.__cleanUp=function(){this._temp_cache&&this._temp_cache.destroy(),this._temp_cache=null,this.data=null,c.prototype.__cleanUp.call(this)},o.prototype._processToCache=function(t,e){var i=$(e).attr("id");i.match(t)&&!this.isDefaultTemplate(i)&&(this._addToCache(e,i),$(e).remove())},o.prototype._addToCache=function(t,e){if(0===t.length)throw new Error("Unable to find item "+e);e||(e=$(t).attr("id")),this._temp_cache||(this._temp_cache=new s.Map),this._temp_cache.add(e,$(t).html())},o.prototype.isDefaultTemplate=function(t){var e=this.getConfigVal("defaultTemplate");return!!e&&(t===e.error||t===e.success||t===e.progress)},o.prototype.initialize=function(){c.prototype.initialize.call(this);var t=new RegExp("^angular_notification_"+this.get("id"));$("#references").children().toArray().forEach(this._processToCache.bind(this,t));var e=this.getConfigVal("defaultTemplate");e&&(e.error&&this._addToCache($("#references #"+e.error)),e.success&&this._addToCache($("#references #"+e.success)),e.progress&&this._addToCache($("#references #"+e.progress))),this.$element.attr({"allex-notification":""}),this.$element.find(this.getConfigVal("contentSelector")).attr("data-ng-include","_ctrl.html")},o.prototype.set_actual=function(t){c.prototype.set_actual.call(this,t);var e=this.getConfigVal("setActual");s.isFunction(e)&&e(this.$element,t)},o.prototype.templateName=function(t){return"#references #angular_notification_"+this.get("id")+"_"+t},o.prototype.findTemplate=function(t){var e=$(this.templateName(t));return e.length?e:null},o.prototype.set_data=function(t){if(this.data===t)return!1;this.data=t;if(this.data){var e=this.templateName(t.name);if(!this.$scopectrl.$templateCache.get(this.templateName(t.name))){if(!(e=this.getConfigVal("defaultTemplate")?this.getConfigVal("defaultTemplate")[t.type]:null))return;e="#references #"+e}this.$scopectrl.html=e,this.$scopectrl.notificationClass=t.notificationClass||null,this.$scopectrl.title=t.title||null,this.$scopectrl.set("data",t.content_data),this.set("actual",!0)}else this._doHide()},o.prototype._doHide=function(){this.$scopectrl.set("data",null),this.set("actual",!1)},o.prototype.set_ftion=function(t){if(t&&(t.data.error||t.data.progress||t.data.result)){var e=null,i=this.getConfigVal("functionConfigs"),n=null,o=null,r=null,a=null;if(t.data.error)r=t.data.error,o=t.name+"_error",n=this.getConfigVal("defaultErrorTitle"),a="error";else if(t.data.result)r=t.data.result,o=t.name+"_success",n=this.getConfigVal("defaultSuccessTitle"),a="success";else if(t.data.progress&&(r=t.data.progress,o=t.name+"_progress",n=this.getConfigVal("defaultProgressTitle"),a="progress",!t.data.running))return void console.log("got progress, but not running",t);i&&i[o]&&(e=i.notificationClass,n=i.title),e=(e||"")+" "+a,this.set("data",{name:o,content_data:r,notificationClass:e,title:n,type:a})}},o.prototype._onScope=function(t){this._temp_cache&&(this._temp_cache.traverse(r.bind(null,this)),this._temp_cache.destroy(),this._temp_cache=null)},e.elements.AngularNotification=o,i.registerElementType("AngularNotification",o),s.inherit(a,p),a.prototype.__cleanUp=function(){this.content_container=null,this.html=null,this.$templateCache=null,this.title=null,this.notificationClass=null,this.data=null,p.prototype.__cleanUp.call(this)},a.prototype.set_content_container=function(t){this.content_container=t},n.controller("allexNotificationController",["$scope","$templateCache",function(t,e){new a(t,e)}]),n.directive("allexNotification",[function(){return{restrict:"A",scope:!0,controller:"allexNotificationController",link:function(t,e){t._ctrl.elementReady(e)}}}]),s.inherit(l,u),l.prototype.destroy=function(){u.prototype.destroy.call(this)},l.prototype.doProcess=function(t,e,i,n,o){e.contentSelector||(e.contentSelector=".modal-body"),this.hookToArray(e,"onActual",this._onActual.bind(this)),this.hookToArray(e,"onInitialized",this._onIntialized.bind(this))},l.prototype._onActual=function(t,e){t.$element.modal(e?"show":"hide")},l.prototype._onIntialized=function(t){t.$element.on("shown.bs.modal",t.set.bind(t,"actual",!0)),t.$element.on("hidden.bs.modal",t.set.bind(t,"actual",!1))},l.prototype.ALLOWED_ON=["AngularNotification","AngularFormLogic"],l.prototype.DEFAULT_CONFIG=function(){return null},i.registerModifier("AngularElements.BootstrapModal",l)}(0,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n,o){"use strict";function r(t,e){s.call(this,l.extend({},t,{ispermanent:!0})),this._dependentElements=new l.Map,e.onReady(this._onReady.bind(this))}function a(t,e){var i=l.arryOperations.difference(e,t);Array.prototype.push.apply(t,i)}var l=ALLEX.lib,s=i.BasicResourceLoader,p=l.q;l.inherit(r,s),r.prototype.__cleanUp=function(){this._dependentElements.destroy(),this._dependentElements=null,s.prototype.__cleanUp.call(this)},r.prototype.doLoad=function(){var t=p.defer();return t.resolve("ok"),t},r.prototype._onReady=function(t){var i=this.getConfigVal("angular_dependencies");i?(i.indexOf("allex_applib")<0&&i.push("allex_applib"),i.indexOf("allex__web_angularcomponent")<0&&i.push("allex__web_angularcomponent")):i=["allex_applib"],e.ANGULAR_REQUIREMENTS.traverse(a.bind(null,i)),n.module("AllexActiveApp",i),n.module("AllexActiveApp").run(this._onModuleStarted.bind(this)),n.bootstrap(document,["AllexActiveApp"])},r.prototype._onModuleStarted=function(){var t=this.getConfigVal("onBootstrapped");l.isFunction(t)&&t(),t=window.AllexAngularBootstrapped,l.isFunction(t)&&t()},r.prototype.DEFAULT_CONFIG=function(){return{angular_dependencies:["allex_applib"]}},r.prototype.registerDependentElement=function(t){this._dependentElements.add(t.get("id"))},r.prototype.dependentElementReady=function(t){this._dependentElements.remove(t.get("id"))},e.resources.AngularBootstrapper=r,i.registerResourceType("AngularBootstrapper",r)}(0,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular,jQuery),function(t,e,i,n){"use strict";function o(){l.call(this)}function r(t,e){return{name:t,data:e}}var a=ALLEX.lib,l=(i.BasicElement,i.BasicModifier,i.BasicProcessor);e.misc.RouterMixIn,i.misc,a.q;a.inherit(o,l),o.prototype.process=function(t){for(var e in this.config)this.createNotificationElement(e,this.config[e],t)},o.prototype.createNotificationElement=function(t,e,i){for(var n,o=0;o<e.length;o++)n=e[o],i.links.push({source:".>"+n,target:t+":ftion",filter:r.bind(null,n)})},i.registerPreprocessor("Notificator",o)}(0,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,jQuery),function(t,e,i,n){"use strict";function o(t){this.modifier=t}function r(t){l.call(this,t)}var a=ALLEX.lib,l=i.BasicModifier,s=e.elements.AngularDataTable;o.prototype.destroy=function(){this.modifier=null},o.prototype.isEmpty=function(t){return modifier.isEmpty(t)},a.inherit(r,l),r.prototype.destroy=function(){l.prototype.destroy.call(this)},r.prototype.ALLOWED_ON=function(){return"AngularDataTable"},r.prototype.DEFAULT_CONFIG=function(){return{eventName:"removeRow",isEmpty:function(t){for(var e in t)if(a.isVal(t[e]))return!1;return!0},isFull:function(t){for(var e in t)if(!a.isVal(t[e]))return!1;return!0}}},r.prototype._addNewRow=function(t){var e,i,n={};for(var o in t.grid.columnDefs)i=(e=t.grid.columnDefs[o]).field||e.name,s.isSpecialColumnName(i)||(n[i]=null);return n},r.prototype.doProcess=function(t,e,i,n,r){var l=this.getConfigVal("eventName");if(this.getConfigVal("newRow")||this.setConfigVal("newRow",this._addNewRow.bind(this,e),!0),!a.isFunction(this.getConfigVal("newRow")))throw new Error("newRow is not a function");if(!a.isFunction(this.getConfigVal("isEmpty")))throw new Error("isEmptyRow must be a function");if(!a.isFunction(this.getConfigVal("isFull")))throw new Error("isFull must be a function");e.appendNewRow=this.getConfigVal("newRow"),e.helperObj||(e.helperObj={}),e.helperObj.autoappend=new o(this);var s=[{triggers:".!afterEdit",references:".",handler:this._onAfterEdit.bind(this,this.getConfigVal("isEmpty"),this.getConfigVal("isFull"))},{triggers:".$element!"+l,references:".",handler:this._onRemoveRequested.bind(this)},{triggers:".:data",references:".",handler:this._onData.bind(this,this.getConfigVal("isEmpty"),this.getConfigVal("isFull"))}];Array.prototype.push.apply(n,s)},r.prototype._onData=function(t,e,i,n){a.isNull(n)||this._doAppend(t,e,i)},r.prototype.isEmptyRow=function(t,e){return e(t)},r.prototype._doAppend=function(t,e,i){var n=i.getTableData(),o=n[n.length-1];0!==n.length?!t(o)&&e(o)&&i.set("row_count",i.get("row_count")+1):i.set("row_count",1)},r.prototype._onAfterEdit=function(t,e,i,n){n.row&&e(n.row)&&this._doAppend(t,e,i)},r.prototype._onRemoveRequested=function(t,e,i){t.removeRow(i)},i.registerModifier("AngularDataTableAutoAppendRow",r)}(0,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,jQuery),function(t,e,i,n){"use strict";function o(t){l.call(this,t)}function r(t){l.call(this,t)}var a=ALLEX.lib,l=i.BasicModifier,s=i.misc;a.inherit(o,l),o.prototype.ALLOWED_ON=function(){return"AngularFormLogic"},o.prototype.DEFAULT_CONFIG=function(){return null},o.prototype.doProcess=function(t,e,i,n,o){s.addHook(e,"onInitialized",this._onInitialized.bind(this,this.config))},o.prototype._onInitialized=function(t,e){var i=e.$element,n=i.find(t.from),o=i.find(t.to),r=a.extend({},t.options),l=a.extend({},t.options);r.maxDate=moment(),l.maxDate=moment(),t.maxDateOffset&&(r.maxDate.add.apply(r.maxDate,t.maxDateOffset),l.maxDate.add.apply(l.maxDate,t.maxDateOffset)),n.datetimepicker(r),o.datetimepicker(l),n.on("dp.change",this._onFromChanged.bind(this,t,e,o,n)),o.on("dp.change",this._onToChanged.bind(this,t,e,o,n)),o.on("dp.show",this._onToShowEvent.bind(this,t,e,o,n)),n.on("dp.show",this._onFromShowEvent.bind(this,t,e,o,n))},o.prototype._onFromShowEvent=function(t,e,i,n,o){var r=n.data("DateTimePicker").date();this._onFromChanged(t,e,i,n,{date:r})},o.prototype._onToShowEvent=function(t,e,i,n,o){var r=moment();t.maxDateOffset&&(r=r.add.apply(r,t.maxDateOffset)),i.data("DateTimePicker").maxDate(r);var a=i.data("DateTimePicker").date();this._onToChanged(t,e,i,n,{date:a})},o.prototype._onToChanged=function(t,e,i,n,o){var r=o.date?o.date.format(t.options.format):null;e.updateHashField(i.attr("name"),r),n.data("DateTimePicker").maxDate(r?moment(r,t.options.format):moment())},o.prototype._onFromChanged=function(t,e,i,n,o){e.updateHashField(n.attr("name"),o.date?o.date.format(t.options.format):null)},i.registerModifier("TimeInterval",o),a.inherit(r,l),r.prototype.DEFAULT_CONFIG=function(){return null},r.prototype.ALLOWED_ON=function(){return"AngularFormLogic"},r.prototype.doProcess=function(t,e,i,n,o){n.push({triggers:"."+this.getConfigVal("trigger")+".$element!click",references:".",handler:this._onResetRequested.bind(this,this.config)})},r.prototype._onResetRequested=function(t,e){t.elements.forEach(this._resetOnField.bind(this,e))},r.prototype._resetOnField=function(t,e){var i=t.$element.find(e),n=i.attr("name");t.updateHashField(n,null),i.datetimepicker("clear")},i.registerModifier("TimeIntervalReset",r)}(0,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,jQuery);