angular.module("allex_applib",[]),function(a,b,c){"use strict";function d(){i.call(this)}function e(a,b,d){Array.prototype.push.apply(a,c.ANGULAR_REQUIREMENTS.get(d))}function f(a,b){for(var d=0;d<a.length;d++)c.ANGULAR_REQUIREMENTS.get(a[d].type)&&!b.get(a[d].type)&&b.add(a[d].type,!0),a[d].options&&a[d].options.elements&&f(a[d].options.elements,b)}var g=a.lib,h=b.registerPreprocessor,i=b.BasicProcessor,j=new g.Map;c.ANGULAR_REQUIREMENTS=j,g.inherit(d,i),d.prototype.destroy=function(){i.prototype.destroy.call(this)},d.prototype.process=function(a){if(!a)throw new Error("No APP descriptor");a.resources||(a.resources=[]);var b,c=a.resources,d=null,h=0;for(b=0;b<c.length;b++)if("AngularBootstrapper"===c[b].type){if(h>0)throw new Error("Multiple instances of AngularBootstrapper found, only one allowed");d=c[b],h++}d||(d={type:"AngularBootstrapper",name:"AngularBootstrapper",options:{angular_dependencies:[]}},c.push(d)),d.options.angular_dependencies||(d.options.angular_dependencies=[]);var i=new g.Map;f(a.elements,i),i.traverse(e.bind(null,d.options.angular_dependencies)),d.options.angular_dependencies=g.arryOperations.unique(d.options.angular_dependencies)},h("AngularPreProcessor",d)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_applib,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent),angular.module("allex_applib",[]),function(a,b,c,d){"use strict";function e(a){h.call(this,a),this.raise=null,this._getResource=null}function f(a){e.call(this,a),this.data=null}var g=a.lib,h=g.BasicAngularController;g.inherit(e,h),e.prototype.__cleanUp=function(){this.raise=null,this._getResource=null,h.prototype.__cleanUp.call(this)},e.prototype.getResource=function(a){return this._getResource?this._getResource(a):void 0},e.prototype.elementReady=function(a){var b=a.data("allex_element");if(!b)throw new Error("Missing allex element ...");b.set("$scopectrl",this)},e.prototype.raiseEvent=function(a,b){this.raise(a,b)},g.inherit(f,e),f.prototype.__cleanUp=function(){this.data=null,e.prototype.__cleanUp.call(this)},f.prototype.set_data=function(a){return this.data!==a&&(this.data=a,!0)},b.elements.AngularDataAwareController=f,b.elements.BasicAngularElementController=e}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(a,b,c,d){"use strict";function e(a,b){g.call(this,a,b),h.call(this),this._addHook("onAngularReady"),this.$scopectrl=null,b&&b.initialData&&this.set("data",b.initialData)}var f=a.lib,g=(f.BasicAngularController,b.elements.WebElement),h=b.mixins.DataElementMixIn;f.q;f.inherit(e,g),e.prototype.__cleanUp=function(){this.$scopectrl=null,h.prototype.__cleanUp.call(this),g.prototype.__cleanUp.call(this)},e.prototype.updateHashField=function(a,b){var c={};c[a]=b,this.set("data",f.extend({},this.get("data"),c))},e.prototype.updateArrayElement=function(a,b){var c=this.get("data"),d=c?c.slice():[];d[a]=b,this.set("data",d)},e.prototype.getArrayDataCopy=function(){var a=this.get("data");return a?a.slice():null},e.prototype.getHashDataCopy=function(){return f.extend({},this.get("data"))},e.prototype.set_$scopectrl=function(a){this.$scopectrl=a,this._onScope(a),this._setRaise(),this.fireHook("onAngularReady",[this]),this.$scopectrl.set("data",this.get("data"))},e.prototype.isScopeReady=function(){return!!this.$scopectrl},e.prototype.executeOnScopeIfReady=function(a,b){if(this.$scopectrl){var c=f.readPropertyFromDotDelimitedString(this.$scopectrl,a,!0);return c.val.apply(c.ctx,b)}},e.prototype._setRaise=function(){this.$scopectrl.set("raise",this.raiseEvent.bind(this)),this.$scopectrl.set("_getResource",this.getResource.bind(this))},e.prototype.set_data=function(a){var b=h.prototype.set_data.call(this,a);return h.prototype.hasDataChanged.call(this,b)&&this.executeOnScopeIfReady("set",["data",this.data]),b},e.prototype.getMeAsElement=function(){return this.$element},e.prototype.initialize=function(){g.prototype.initialize.call(this),this.$element.data("allex_element",this),this.attachHook("onAngularReady",this.getConfigVal("onAngularReady"))},e.prototype.$apply=function(){this.$scopectrl&&this.$scopectrl.$apply()},e.prototype._onScope=f.dummyFunc,b.elements.BasicAngularElement=e}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(a,b,c,d){"use strict";function e(a,b){i.call(this,a,b)}function f(a,b){i.call(this,a,b)}var g=a.lib,h=b.elements.AngularDataAwareController,i=b.elements.BasicAngularElement;g.q;g.inherit(e,i),e.prototype.__cleanUp=function(){i.prototype.__cleanUp.call(this)},e.prototype.initialize=function(){i.prototype.initialize.call(this),this.$element.attr("data-allex-angular-element","")},b.elements.AngularElement=e,c.registerElementType("AngularElement",e),d.controller("allexAngularElementController",["$scope",function(a){new h(a)}]),d.directive("allexAngularElement",[function(){return{restrict:"A",scope:!0,controller:"allexAngularElementController",link:function(a,b,c){a._ctrl.elementReady(b)}}}]),g.inherit(f,i),f.prototype.set_data=function(a){var b,c,d=i.prototype.set_data.call(this,a);if(d!==!1&&(b=this.__parent.$scopectrl,c=this.$element.attr("name"),b&&c))if(b.data)b.data[c]=a;else{var e={};e[c]=a,b.set("data",e)}return d},b.elements.AngularFormElement=f,c.registerElementType("AngularFormElement",f)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(a,b,c,d){"use strict";function e(a,b){n.call(this,a,b),this.$form=null,this.submit=new l.HookCollection,this.partialSubmit=new l.HookCollection,this.valid=null,this._valid_l=null,this.validfields={},this._validfields_l={},this._default_values={},this.change=new l.HookCollection,this.initial=b?b.initial:null,this.ftion_status=null,this.progress=null,this.array_keys=b?b.array_keys:null}function f(a,b,c){c in a||(a[c]=b)}function g(a){m.call(this,a),this.data={},this.valid=!1,this._watcher=null,this.validation=null,this._onChange=null,this.config=null,this.progress=null,this.ftion_status=null,this.disabled=!1}function h(a){o.call(this,a)}function i(a){o.call(this,a)}function j(a){return a.ftion}function k(a){o.call(this,a)}var l=a.lib,m=b.elements.BasicAngularElementController,n=b.elements.BasicAngularElement,o=(l.q,c.BasicModifier),p=/\[\]$/;l.inherit(e,n),e.prototype.__cleanUp=function(){this.progress=null,this.ftion_status=null,this.array_keys=null,this.initial=null,this.change.destroy(),this.change=null,this._default_values=null,l.traverseShallow(this._validfields_l,this._unlisten.bind(this)),this.validfields=null,this.$form=null,this._valid_l&&this._valid_l.destroy(),this._valid_l=null,this.partialSubmit.destroy(),this.partialSubmit=null,this.submit.destroy(),this.submit=null,this.valid=!1,n.prototype.__cleanUp.call(this)},e.prototype.set_ftion_status=function(a){var b=!1;a&&(this.ftion_status?b=this.ftion_status.working&&a.result:a.result&&(b=!0)),this.ftion_status=a;var c=this.getConfigVal("closeOnSuccess");console.log("was active?",b,c),this.isScopeReady()&&b&&((!0===c||l.isNumber(c))&&this.doCloseOnSuccess(c),this.getConfigVal("clearOnSuccess")&&this.set("data",null)),this.executeOnScopeIfReady("set",["ftion_status",a])},e.prototype.doCloseOnSuccess=function(a){!0===a&&(a=0),this.executeOnScopeIfReady("set",["disabled",!1]),l.runNext(this.set.bind(this,"actual",!1),a)},e.prototype.set_progress=function(a){this.progress=a,this.executeOnScopeIfReady("set",["progress",a])},e.prototype._unlisten=function(a){l.isFunction(a)&&a()},e.prototype.set_actual=function(a){n.prototype.set_actual.call(this,a),this.set("ftion_status",null),this.set("progress",null),this.executeOnScopeIfReady("set",["disabled",!a])},e.prototype.initialize=function(){n.prototype.initialize.call(this),this.$element.attr({"data-allex-angular-form-logic":""}),this.$form=this.$element.is("form")?this.$element:this.$element.find("form"),this.$form.attr({name:this.get("id"),novalidate:""}),this.$form.removeAttr("action"),this.$form.find("[name]").toArray().forEach(this._prepareForAngular.bind(this)),this.appendHiddenFields(this.getConfigVal("hidden_fields"))},e.prototype._prepareForAngular=function(a){var b=jQuery(a),c=b.attr("name"),d=this.getModelName(c);if(!d)return void console.warn("There is no name for input field ",b.attr("id"),"form logic",this.get("id"));var e=b.attr("data-ng-readonly"),f=e&&e.length?"("+e+") ||":"";f+="(_ctrl.disabled || _ctrl.progress)",b.attr({"data-allex-angular-validate":"_ctrl.validation."+d,"data-ng-change":"_ctrl.onChange('"+d+"', _ctrl.data."+d+")"}),b.attr("readonly")||b.attr("data-ng-readonly",f),b.attr("data-ng-model")||b.attr("ng-model")||b.attr("data-ng-model","_ctrl.data."+d),this._validfields_l[d]=null},e.prototype.appendHiddenFields=function(a){a&&a.length&&a.forEach(this._appendHiddenField.bind(this))},e.prototype._appendHiddenField=function(a){var b=l.isString(a)?a:a.name,c={name:b,type:"hidden"},d=!l.isString(a);d&&(c.required=a.required?"":void 0,"value"in a&&(this._default_values[b]=a.value)),this.findByFieldName(b).remove();var e=$("<input>").attr(c);this._prepareForAngular(e),this.$form.append(e)},e.prototype.findByFieldName=function(a){return this.$form.find('[name="'+a+'"]')},e.prototype.toArray=function(a){return l.hashToArray(a,this.get("data"))},e.prototype.fireSubmit=function(){this.submit.fire(this.array_keys?this.toArray(this.array_keys):this.get("data"))},e.prototype.firePartialSubmit=function(a){this.isFieldValid(a)&&this.partialSubmit.fire(a,this.data?this.data[a]:null)},e.prototype.set_data=function(a){return l.traverseShallow(this._default_values,f.bind(null,a)),n.prototype.set_data.call(this,a)},e.prototype.get_data=function(){return this.$scopectrl?this.$scopectrl.get("data"):this.data},e.prototype.getModelName=function(a){var b=a;return a.match(p)&&(b=a.replace(p,"")),b},e.prototype.revalidate=function(){if(this.$scopectrl){var a=this.$scopectrl.scope[this.id];if(a)for(var b in this.validfields)a[b]&&a[b].$validate()}},e.prototype._onScope=function(a){this._valid_l=a.attachListener("valid",this.set.bind(this,"valid")),a.set("validation",this.getConfigVal("validation")),a.set("_onChange",this._onChanged.bind(this)),l.traverseShallow(this._validfields_l,this._watchForValid.bind(this,a.scope,this.$form.attr("name"))),a.set("config",this.getConfigVal("form")),a.set("progress",this.get("progress")),a.set("ftion_status",this.get("ftion_status")),a.set("disabled",!this.get("actual")),this.initial&&l.runNext(this._setInitial.bind(this))},e.prototype._onChanged=function(a,b,c){this.changed.fire("data",a),this.change.fire(b,c)},e.prototype._setInitial=function(a){this.set("data",l.extend({},this.initial,a));for(var b in this.initial)this.change.fire(b,this.initial[b])},e.prototype.resetElement=function(a){n.prototype.resetElement.call(this,a),this.resetForm(a)},e.prototype.resetForm=function(a){this._setInitial(a)},e.prototype._watchForValid=function(a,b,c,d){this._validfields_l[d]=a.$watch("_ctrl.data."+d,this._updateError.bind(this,a,b,d))},e.prototype._updateError=function(a,b,c){var d=l.extend({},this.validfields);return a[b][c]?(d[c]=!Object.keys(a[b][c].$error).length,void this.set("validfields",d)):void console.warn("no "+c+" in validator")},e.prototype.isFieldValid=function(a){return!(!this.$scopectrl||!this.$scopectrl.scope[this.get("id")])&&this.$scopectrl.scope[this.get("id")][a].$valid},e.prototype.set_valid=function(a){return this.valid!==a&&(this.valid=a,!0)},e.prototype.empty=function(){this.set("data",{})},e.prototype.setInputEnabled=function(a,b){this.$form.find('[name="'+a+'"]').attr("data-ng-disabled",b?"false":"true"),this.executeOnScopeIfReady("$apply")},e.prototype.disableInput=function(a){this.setInputEnabled(a,!1)},e.prototype.enableInput=function(a){this.setInputEnabled(a,!0)},e.prototype.isFormValid=function(){for(var a in this.validfields)if(!this.isFieldValid(a))return!1;return!0},b.elements.AngularFormLogic=e,c.registerElementType("AngularFormLogic",e),l.inherit(g,m),g.prototype.__cleanUp=function(){this.disabled=null,this.ftion_status=null,this.progress=null,this.validation=null,this._watcher&&this._watcher(),this._watcher=null,this.data=null,this.valid=null,this._onChange=null,this.config=null,m.prototype.__cleanUp.call(this)},g.prototype.onChange=function(a,b){l.isFunction(this._onChange)&&this._onChange(this.data,a,b)},g.prototype.elementReady=function(a){m.prototype.elementReady.call(this,a),this._watcher=this.scope.$watch(a.attr("id")+".$valid",this.set.bind(this,"valid"))},g.prototype.set_valid=function(a){return this.valid!==a&&(this.valid=a||null,!0)},g.prototype.validate=function(a,b,c){var d=this.validation;return!d||(!d[a]||!!this.validateJSON(d[a].json_schema,b)&&this.validateFunction(d[a].custom,b))},g.prototype.validateJSON=function(a,b){if(!a)return!0;var c=l.jsonschema.validate(b,a);return!c.errors.length},g.prototype.validateFunction=function(a,b){return!l.isFunction(a)||a(b,this.data)},d.controller("allexAngularFormLogicController",["$scope",function(a){new g(a)}]),d.directive("allexAngularFormLogic",function(){return{restrict:"A",scope:!0,controller:"allexAngularFormLogicController",link:function(a,b,c){a._ctrl.elementReady(b)}}}),l.inherit(h,o),h.prototype.destroy=function(){o.prototype.destroy.call(this)},h.prototype.doProcess=function(a,b,c,d,e){var f=b.elements,g=a+"Submit",h="."+g;switch(f.push({name:g,type:"WebElement"}),c.push({source:h+".$element!click",target:".>fireSubmit"},{source:".:valid",target:"$element.#"+g+":attr.disabled",filter:this._decideDisabled.bind(this)}),this.getConfigVal("actual")){case"always":c.push({source:".:actual",target:h+":actual"});break;default:case"valid":d.push({triggers:[".:valid, .:actual"],references:h+", .",handler:function(a,b){a.set("actual",b.get("valid")&&b.get("actual"))}})}},h.prototype._decideDisabled=function(a){return a?void 0:"disabled"},h.ALLOWED_ON=["AngularFormLogic"],h.prototype.DEFAULT_CONFIG=function(){return{actualon:"valid"}},c.registerModifier("AngularFormLogic.submit",h),l.inherit(i,o),i.prototype.destroy=function(){o.prototype.destroy.call(this)},i.prototype.doProcess=function(a,b,c,d,e){var f=this.getConfigVal("form"),g=this.getConfigVal("cbs");if(!f)throw new Error("No form in SubmissionModifier");if(!g)throw new Error("No cbs in SubmissionModifier");d.push({triggers:f+"!submit",references:[f].concat(g.map(j)).join(","),handler:this._onSubmit.bind(this,g)});for(var h=f+":progress",i=f+":ftion_status",k=0;k<g.length;k++)c.push({source:g[k].ftion,target:h,filter:this._processProgress.bind(this)},{source:g[k].ftion,target:i,filter:this._processStatus.bind(this)})},i.prototype._onSubmit=function(a,b){for(var c=a.length,d=2,e=Array.prototype.slice.call(arguments,d,a.length+d),f=arguments[d+a.length],g=0;g<c;g++)a[g].conditional&&!a[g].conditional(f)||e[g](l.isFunction(a[g].filter)?a[g].filter(f,b):[f])},i.prototype._processFilter=function(a){},i.prototype._processProgress=function(a){return a&&a.working&&a.progress},i.prototype._processStatus=function(a){return!a||a.working?null:a.error?{error:a.error}:a.result?{result:a.result}:null},i.prototype.DEFAULT_CONFIG=function(){return null},c.registerModifier("SubmissionModifier",i),l.inherit(k,o),k.prototype.destroy=function(){o.prototype.destroy.call(this)},k.ALLOWED_ON=["AngularFormLogic"],k.prototype._prepareItem=function(a,b,c,d,e,f){var g=f.path,h=f.field;if(!h)throw new Error("No field given in FieldBindingModifier "+a);g||(g=a+"_partialSubmit_"+h),c.push({source:".:actual",target:g+":actual"}),d.push({triggers:[".:actual",".:data"],references:"., "+g,handler:this._decide.bind(this,h)},{triggers:g+".$element!click",references:".",handler:this._onTrigger.bind(this,h)})},k.prototype.doProcess=function(a,b,c,d,e){var f=this.getConfigVal("list");if(l.isArray(f))return void f.forEach(this._prepareItem.bind(this,a,b,c,d,e));var g=this.getConfigVal("path"),h=this.getConfigVal("field");h&&this._prepareItem(a,b,c,d,e,{path:g,field:h})},k.prototype._decide=function(a,b,c){c.$element.attr("disabled",b.isFieldValid(a)?null:"disabled")},k.prototype._onTrigger=function(a,b){b.firePartialSubmit(a)},k.prototype.DEFAULT_CONFIG=function(){return null},c.registerModifier("AngularFormLogic.bindField",k)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(a,b,c,d){"use strict";function e(a,b){"headerCellFilter"in b||(b.headerCellFilter=a)}function f(a){var b=n.extend({},a.actions,{field:"-",enableFiltering:!1});return e(a.defaultHeaderCellFilter,b),b}function g(a,b){p.call(this,a,b),this.afterEdit=new n.HookCollection,this.config.grid=n.extend({},g.DEFAULT_GRID_CONFIG,this.config.grid),this.config.grid.data||(this.config.grid.data="_ctrl.data"),this.config.defaultHeaderCellFilter&&this.config.grid.columnDefs.forEach(e.bind(null,this.config.defaultHeaderCellFilter))}function h(a){return j("enableCellEdit",a)}function i(a){return j("enableColumnResizing",a)}function j(a,b){if(b[a])return!0}function k(a,b){a[b]&&"#"===a[b].charAt(0)&&(a[b]=jQuery("#references > "+a[b]).html())}function l(a,b){b.type&&(b.type=a[b.type]),b.condition&&n.isString(b.condition)&&(b.condition=a[b.condition])}function m(a,b,c){o.call(this,a),q.call(this),this.uiGridConstants=c,this.data=[],this.gridOptions=null,this.api=null,this._listenToEditEvents=!1}var n=a.lib,o=b.elements.AngularDataAwareController,p=(b.mixins.DataElementMixIn,b.elements.BasicAngularElement),q=n.CBMapable;n.q;n.inherit(g,p),g.prototype.__cleanUp=function(){this.afterEdit.destroy(),this.afterEdit=null,p.prototype.__cleanUp.call(this)},g.prototype._replacePossibleTemplates=function(a){k(a,"cellTemplate"),k(a,"filterHeaderTemplate")},g.prototype.initialize=function(){p.prototype.initialize.call(this);var a=this.config.grid.enableCellEdit||n.traverseConditionally(this.getColumnDefs(),h),b=this.config.grid.enableColumnResizing||n.traverseConditionally(this.getColumnDefs(),i),c=this.getConfigVal("noDataContent"),d=this.getConfigVal("grid.data");this.getColumnDefs().forEach(this._replacePossibleTemplates.bind(this));var e=$('<div class="table_container" ng-show="'+d+'.length"></div>'),g=$('<div class="no_data_container" ng-show = "!'+d+'.length"></div>');e.attr("ui-grid","_ctrl.gridOptions"),e.attr("ui-grid-auto-resize",""),a&&e.attr("ui-grid-edit",""),b&&e.attr("ui-grid-resize-columns",""),n.isString(c)&&("#"===c[0]?g.append($("#references > "+c).html()):g.append(c)),c===!0&&g.append(this.findDomReference("nodata").html()),e.addClass("grid"),this.$element.attr({"data-allex-angular-data-table":""}),this.$element.append(e),c&&this.$element.append(g);var j=this.findDomReference("actions"),k=this.getConfigVal("actionsWrapper");if(k&&(k=$(k),j=k.append(j)),console.log("samo da vidim ...",j),0!==j.length){var l=n.arryOperations.findElementWithProperty(this.config.grid.columnDefs,"field","-"),m={displayName:j.attr("data-title")||"Actions",cellTemplate:j.html()};l?(l.displayName||(l.displayName=m.displayName),l.cellTemplate||(l.cellTemplate=m.cellTemplate)):this.config.grid.columnDefs.unshift(n.extend({},m,f(this.config)))}},g.prototype.getApi=function(){return this.$scopectrl?this.$scopectrl.api:null},g.prototype._onScope=function(a){var b={appendNewRow:this.appendNewRow.bind(this)};""===this.$element.find(".grid.table_container").attr("ui-grid-edit")&&(b.afterEdit=this.afterEdit.fire.bind(this.afterEdit)),a.set("_cbmap",b),this.config.grid.enableHorizontalScrollbar=this.config.grid.enableHorizontalScrollbar===!1?a.uiGridConstants.scrollbars.NEVER:a.uiGridConstants.scrollbars.ALWAYS,this.config.grid.enableVerticalScrollbar=this.config.grid.enableVerticalScrollbar===!1?a.uiGridConstants.scrollbars.NEVER:a.uiGridConstants.scrollbars.ALWAYS,this.config.grid.columnDefs.forEach(this._processFilters.bind(this,a)),a.set("gridOptions",this.config.grid)},g.prototype._processFilters=function(a,b,c){var d=a.uiGridConstants.filter;return b.filter?void l(d,b.filter):b.filters?void b.filters.forEach(l.bind(null,d)):void 0},g.prototype.set_data=function(a){var b=p.prototype.set_data.call(this,a);!1!==b&&(this.executeOnScopeIfReady("set",["data",a]),this.executeOnScopeIfReady("api.core.refresh"))},g.prototype.getCleanData=function(){angular.copy(this.getTableData())},g.prototype.appendNewRow=function(a){var b={};this.getConfigVal("config.bSetNewRowProps");var c=this.getConfigVal("appendNewRow");return c?c(this,a,b):b},g.prototype.get_rows=function(){return this.$scopectrl.api?this.$scopectrl.api.grid.rows:null},g.prototype.getElement=function(a){return"$element"===a?this.$element:p.prototype.getElement.call(this,a)},g.prototype.set_row_count=function(a){return this.executeOnScopeIfReady("set",["row_count",a])},g.prototype.get_row_count=function(){return this.executeOnScopeIfReady("get",["row_count"])},g.prototype.getColumnDefs=function(){return this.getConfigVal("grid.columnDefs")},g.prototype.$apply=function(){p.prototype.$apply.call(this),this.executeOnScopeIfReady("api.core.refresh")},g.prototype.removeAllColumns=function(){if(this.isScopeReady())this.config.grid.columnDefs.splice(0,this.config.grid.columnDefs.length),this.refreshGrid();else{var a=this.getColumnDefs();a.splice(0,a.length)}},g.prototype.appendColumn=function(a){this.isScopeReady()?(this.config.grid.columnDefs.push(a),this.refreshGrid()):this.getColumnDefs().push(a)},g.prototype.set_column_defs=function(a){if(this.isScopeReady())this.config.grid.columnDefs=a,this.refreshGrid();else{var b=this.getColumnDefs();b.splice(0,b.length),Array.prototype.push.apply(b,a)}},g.prototype.updateColumnDef=function(a,b){if(this.isScopeReady()){var c=this.getColumnDef(a);return c.colDef=b,void this.refreshGrid()}var d=this.getColumnDef(a),e=this.getColumnDefs(),f=e.indexOf(d);if(f<0)throw new Error("No column definition for name ",a);e[f]=b},g.prototype.getColumnDef=function(a){if(this.isScopeReady()&&this.getApi().grid.columns.length){var b=this.getApi().grid.getColumn(a);return b?b.colDef:null}return n.arryOperations.findElementWithProperty(this.getColumnDefs(),"name",a)},g.prototype.refreshGrid=function(){this.executeOnScopeIfReady("api.grid.refresh")},g.prototype.getTableData=function(){return this.executeOnScopeIfReady("getActualData")},g.prototype.getRowIndexUponEntity=function(a){for(var b=this.getApi().grid.rows,c=0;c<b.length;c++)if(b[c].entity.$$hashKey===a.$$hashKey)return c;return-1},g.prototype.removeRow=function(a){var b=this.getTableData(),c=this.getRowIndexUponEntity(a);c<0||(b.splice(c,1),this.refreshGrid())},g.isSpecialColumnName=function(a){return"-"===a},g.DEFAULT_GRID_CONFIG=null,b.elements.AngularDataTable=g,c.registerElementType("AngularDataTable",g),b.ANGULAR_REQUIREMENTS.add("AngularDataTable",["ui.grid","ui.grid.edit","ui.grid.autoResize","ui.grid.resizeColumns"]),n.inherit(m,o),q.addMethods(m),m.prototype.__cleanUp=function(){this.uiGridConstants=null,this.rowCountChanged.destroy(),this.rowCountChanged=null,this.editDone=new n.HookCollection,this.gridOptions=null,this.data=null,this.api=null,q.prototype.__cleanUp.call(this),o.prototype.__cleanUp.call(this)},m.prototype.set_gridOptions=function(a){return this.gridOptions!==a&&(this.api=null,this.gridOptions=a,!this.gridOptions||void(this.gridOptions.onRegisterApi=this.set.bind(this,"api")))},m.prototype.set_api=function(a){this.api!==a&&(this.api=a,this._cbmap&&this._cbmap.afterEdit&&this.api.edit.on.afterCellEdit(this.scope,this._onAfterEdit.bind(this)))},m.prototype._onAfterEdit=function(a,b,c,d){d!==c&&this.call_cb("afterEdit",[{newValue:c,oldValue:d,row:a,field:b.name}])},m.prototype.set_row_count=function(a){var b=this.getActualData();if(!n.isArray(b))return!1;var c=b.length,d=null;if(a===c)return!1;if(a<c)b.splice(a,c-a);else for(;b.length<a;)d=this.call_cb("appendNewRow",[b.length]),b.push(d);return!0},m.prototype.getActualData=function(){return n.isString(this.gridOptions.data)?this.scope.$eval(this.gridOptions.data):this.gridOptions.data},m.prototype.get_row_count=function(){return this.getActualData().length},d.controller("allexAngularDataTableController",["$scope","$parse","uiGridConstants",function(a,b,c){new m(a,b,c)}]),d.directive("allexAngularDataTable",[function(){return{restrict:"A",scope:!0,controller:"allexAngularDataTableController",link:function(a,b,c){a._ctrl.elementReady(b)}}}])}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(a,b,c,d){"use strict";function e(a,b){k.call(this,a,b),this.data=null,this._temp_cache=null}function f(a,b,c){a.$scopectrl.$templateCache.put("#references #"+c,b)}function g(a,b){j.call(this,a),this.$templateCache=b,this.content_container=null,this.html=null,this.data=null,this.title=null,this.notificationClass=null}function h(a){l.call(this,a)}var i=a.lib,j=b.elements.BasicAngularElementController,k=b.elements.BasicAngularElement,l=(i.q,c.BasicModifier);i.inherit(e,k),e.prototype.__cleanUp=function(){this._temp_cache&&this._temp_cache.destroy(),this._temp_cache=null,this.data=null,k.prototype.__cleanUp.call(this)},e.prototype._processToCache=function(a,b){var c=$(b).attr("id");c.match(a)&&this.isDefaultTemplate(c)&&(this._addToCache(b,c),$(b).remove())},e.prototype._addToCache=function(a,b){if(0===a.length)throw new Error("Unable to find item "+b);b||(b=$(a).attr("id")),this._temp_cache||(this._temp_cache=new i.Map),this._temp_cache.add(b,$(a).html())},e.prototype.isDefaultTemplate=function(a){var b=this.getConfigVal("defaultTemplate");return!!b&&(a===b.error||a===b.success||a===b.progress)},e.prototype.initialize=function(){k.prototype.initialize.call(this);var a=new RegExp("^angular_notification_"+this.get("id"));$("#references").children().toArray().forEach(this._processToCache.bind(this,a));var b=this.getConfigVal("defaultTemplate");b&&(b.error&&this._addToCache($("#references #"+b.error)),b.success&&this._addToCache($("#references #"+b.success)),b.progress&&this._addToCache($("#references #"+b.progress))),this.$element.attr({"allex-notification":""}),this.$element.find(this.getConfigVal("contentSelector")).attr("data-ng-include","_ctrl.html")},e.prototype.set_actual=function(a){k.prototype.set_actual.call(this,a);var b=this.getConfigVal("setActual");i.isFunction(b)&&b(this.$element,a)},e.prototype.templateName=function(a){return"#references #angular_notification_"+this.get("id")+"_"+a},e.prototype.findTemplate=function(a){var b=$(this.templateName(a));return b.length?b:null},e.prototype.set_data=function(a){if(this.data===a)return!1;this.data=a;if(!this.data)return void this._doHide();var b=this.templateName(a.name);if(!this.$scopectrl.$templateCache.get(this.templateName(a.name))){if(b=this.getConfigVal("defaultTemplate")?this.getConfigVal("defaultTemplate")[a.type]:null,!b)return;b="#references #"+b}this.$scopectrl.html=b,this.$scopectrl.notificationClass=a.notificationClass||null,this.$scopectrl.title=a.title||null,this.$scopectrl.set("data",a.content_data),this.set("actual",!0)},e.prototype._doHide=function(){this.$scopectrl.set("data",null),this.set("actual",!1)},e.prototype.set_ftion=function(a){if(a&&(a.data.error||a.data.progress||a.data.result)){var b=null,c=this.getConfigVal("functionConfigs"),d=null,e=null,f=null,g=null;if(a.data.error)f=a.data.error,e=a.name+"_error",d=this.getConfigVal("defaultErrorTitle"),g="error";else if(a.data.result)f=a.data.result,e=a.name+"_success",d=this.getConfigVal("defaultSuccessTitle"),g="success";else if(a.data.progress&&(f=a.data.progress,e=a.name+"_progress",d=this.getConfigVal("defaultProgressTitle"),g="progress",!a.data.running))return void console.log("got progress, but not running",a);c&&c[e]&&(b=c.notificationClass,d=c.title),b=(b||"")+" "+g,this.set("data",{name:e,content_data:f,notificationClass:b,title:d,type:g})}},e.prototype._onScope=function(a){this._temp_cache&&(this._temp_cache.traverse(f.bind(null,this)),this._temp_cache.destroy(),this._temp_cache=null)},b.elements.AngularNotification=e,c.registerElementType("AngularNotification",e),i.inherit(g,j),g.prototype.__cleanUp=function(){this.content_container=null,this.html=null,this.$templateCache=null,this.title=null,this.notificationClass=null,this.data=null,j.prototype.__cleanUp.call(this)},g.prototype.set_content_container=function(a){this.content_container=a},d.controller("allexNotificationController",["$scope","$templateCache",function(a,b){new g(a,b)}]),d.directive("allexNotification",[function(){return{restrict:"A",scope:!0,controller:"allexNotificationController",link:function(a,b){a._ctrl.elementReady(b)}}}]),i.inherit(h,l),h.prototype.destroy=function(){l.prototype.destroy.call(this)},h.prototype.doProcess=function(a,b,c,d,e){b.contentSelector||(b.contentSelector=".modal-body"),this.hookToArray(b,"onActual",this._onActual.bind(this)),this.hookToArray(b,"onInitialized",this._onIntialized.bind(this))},h.prototype._onActual=function(a,b){a.$element.modal(b?"show":"hide")},h.prototype._onIntialized=function(a){a.$element.on("shown.bs.modal",a.set.bind(a,"actual",!0)),a.$element.on("hidden.bs.modal",a.set.bind(a,"actual",!1))},h.prototype.ALLOWED_ON=["AngularNotification","AngularFormLogic"],h.prototype.DEFAULT_CONFIG=function(){return null},c.registerModifier("AngularElements.BootstrapModal",h)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(a,b,c,d,e){"use strict";function f(a,b){h.call(this,g.extend({},a,{ispermanent:!0})),this._dependentElements=new g.Map,b.onReady(this._onReady.bind(this))}var g=a.lib,h=c.BasicResourceLoader,i=g.q;g.inherit(f,h),f.prototype.__cleanUp=function(){this._dependentElements.destroy(),this._dependentElements=null,h.prototype.__cleanUp.call(this)},f.prototype.doLoad=function(){var a=i.defer();return a.resolve("ok"),a},f.prototype._onReady=function(a){var b=this.getConfigVal("angular_dependencies");b?(b.indexOf("allex_applib")<0&&b.push("allex_applib"),b.indexOf("allex__web_angularcomponent")<0&&b.push("allex__web_angularcomponent")):b=["allex_applib"],d.module("AllexActiveApp",b),d.module("AllexActiveApp").run(this._onModuleStarted.bind(this)),d.bootstrap(document,["AllexActiveApp"])},f.prototype._onModuleStarted=function(){var a=this.getConfigVal("onBootstrapped");g.isFunction(a)&&a(),a=window.AllexAngularBootstrapped,g.isFunction(a)&&a()},f.prototype.DEFAULT_CONFIG=function(){return{angular_dependencies:["allex_applib"]}},f.prototype.registerDependentElement=function(a){this._dependentElements.add(a.get("id"))},f.prototype.dependentElementReady=function(a){this._dependentElements.remove(a.get("id"))},b.resources.AngularBootstrapper=f,c.registerResourceType("AngularBootstrapper",f)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular,jQuery),function(a,b,c,d){"use strict";function e(){h.call(this)}function f(a,b){return{name:a,data:b}}var g=a.lib,h=(c.BasicElement,c.BasicModifier,c.BasicProcessor);b.misc.RouterMixIn,c.misc,g.q;g.inherit(e,h),e.prototype.process=function(a){for(var b in this.config)this.createNotificationElement(b,this.config[b],a)},e.prototype.createNotificationElement=function(a,b,c){for(var d,e=0;e<b.length;e++)d=b[e],c.links.push({source:".>"+d,target:a+":ftion",filter:f.bind(null,d)})},c.registerPreprocessor("Notificator",e)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,jQuery),function(a,b,c,d){"use strict";function e(a){this.modifier=a}function f(a){h.call(this,a)}var g=a.lib,h=c.BasicModifier,i=b.elements.AngularDataTable;return e.prototype.destroy=function(){this.modifier=null},e.prototype.isEmpty=function(a){return modifier.isEmpty(a)},g.inherit(f,h),f.prototype.destroy=function(){h.prototype.destroy.call(this)},f.prototype.ALLOWED_ON=function(){return"AngularDataTable"},f.prototype.DEFAULT_CONFIG=function(){return{eventName:"removeRow",isEmpty:function(a){for(var b in a)if(g.isVal(a[b]))return!1;return!0},isFull:function(a){for(var b in a)if(!g.isVal(a[b]))return!1;return!0}}},f.prototype._addNewRow=function(a){
var b,c,d={};for(var e in a.grid.columnDefs)b=a.grid.columnDefs[e],c=b.field||b.name,i.isSpecialColumnName(c)||(d[c]=null);return d},f.prototype.doProcess=function(a,b,c,d,f){var h=this.getConfigVal("eventName");if(this.getConfigVal("newRow")||this.setConfigVal("newRow",this._addNewRow.bind(this,b),!0),!g.isFunction(this.getConfigVal("newRow")))throw new Error("newRow is not a function");if(!g.isFunction(this.getConfigVal("isEmpty")))throw new Error("isEmptyRow must be a function");if(!g.isFunction(this.getConfigVal("isFull")))throw new Error("isFull must be a function");b.appendNewRow=this.getConfigVal("newRow"),b.helperObj||(b.helperObj={}),b.helperObj.autoappend=new e(this);var i=[{triggers:".!afterEdit",references:".",handler:this._onAfterEdit.bind(this,this.getConfigVal("isEmpty"),this.getConfigVal("isFull"))},{triggers:".$element!"+h,references:".",handler:this._onRemoveRequested.bind(this)},{triggers:".:data",references:".",handler:this._onData.bind(this,this.getConfigVal("isEmpty"),this.getConfigVal("isFull"))}];Array.prototype.push.apply(d,i)},f.prototype._onData=function(a,b,c,d){g.isNull(d)||this._doAppend(a,b,c)},f.prototype.isEmptyRow=function(a,b){return b(a)},f.prototype._doAppend=function(a,b,c){var d=c.getTableData(),e=d[d.length-1];return 0===d.length?void c.set("row_count",1):void(!a(e)&&b(e)&&c.set("row_count",c.get("row_count")+1))},f.prototype._onAfterEdit=function(a,b,c,d){d.row&&b(d.row)&&this._doAppend(a,b,c)},f.prototype._onRemoveRequested=function(a,b,c){a.removeRow(c)},c.registerModifier("AngularDataTableAutoAppendRow",f),f}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,jQuery),function(a,b,c,d){"use strict";function e(a){h.call(this,a)}function f(a){h.call(this,a)}var g=a.lib,h=c.BasicModifier,i=c.misc;g.inherit(e,h),e.prototype.ALLOWED_ON=function(){return"AngularFormLogic"},e.prototype.DEFAULT_CONFIG=function(){return null},e.prototype.doProcess=function(a,b,c,d,e){i.addHook(b,"onInitialized",this._onInitialized.bind(this,this.config))},e.prototype._onInitialized=function(a,b){var c=b.$element,d=c.find(a.from),e=c.find(a.to),f=g.extend({},a.options),h=g.extend({},a.options);f.maxDate=moment(),h.maxDate=moment(),a.maxDateOffset&&(f.maxDate.add.apply(f.maxDate,a.maxDateOffset),h.maxDate.add.apply(h.maxDate,a.maxDateOffset)),d.datetimepicker(f),e.datetimepicker(h),d.on("dp.change",this._onFromChanged.bind(this,a,b,e,d)),e.on("dp.change",this._onToChanged.bind(this,a,b,e,d))},e.prototype._onToChanged=function(a,b,c,d,e){var f=e.date?e.date.format(a.options.format):null;b.updateHashField(c.attr("name"),f),d.data("DateTimePicker").maxDate(f?moment(f,a.options.format):moment())},e.prototype._onFromChanged=function(a,b,c,d,e){b.updateHashField(d.attr("name"),e.date?e.date.format(a.options.format):null)},c.registerModifier("TimeInterval",e),g.inherit(f,h),f.prototype.DEFAULT_CONFIG=function(){return null},f.prototype.ALLOWED_ON=function(){return"AngularFormLogic"},f.prototype.doProcess=function(a,b,c,d,e){d.push({triggers:"."+this.getConfigVal("trigger")+".$element!click",references:".",handler:this._onResetRequested.bind(this,this.config)})},f.prototype._onResetRequested=function(a,b){a.elements.forEach(this._resetOnField.bind(this,b))},f.prototype._resetOnField=function(a,b){var c=a.$element.find(b),d=c.attr("name");a.updateHashField(d,null),c.datetimepicker("clear")},c.registerModifier("TimeIntervalReset",f)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,jQuery);