angular.module("allex_applib",[]),function(t,e,i){"use strict";var n=t.lib,o=e.registerPreprocessor,r=e.BasicProcessor,a=new n.Map;function l(){r.call(this)}i.ANGULAR_REQUIREMENTS=a,n.inherit(l,r),l.prototype.destroy=function(){r.prototype.destroy.call(this)},l.prototype.process=function(t){if(!t)throw new Error("No APP descriptor");t.resources||(t.resources=[]);var e,o=t.resources,r=null,a=0;for(e=0;e<o.length;e++)if("AngularBootstrapper"===o[e].type){if(a>0)throw new Error("Multiple instances of AngularBootstrapper found, only one allowed");r=o[e],a++}r||(r={type:"AngularBootstrapper",name:"AngularBootstrapper",options:{angular_dependencies:[]}},o.push(r)),r.options.angular_dependencies||(r.options.angular_dependencies=[]);var l=new n.Map;!function t(e,n){if(!e)return;for(var o=0;o<e.length;o++)i.ANGULAR_REQUIREMENTS.get(e[o].type)&&!n.get(e[o].type)&&n.add(e[o].type,!0),e[o].options&&e[o].options.elements&&t(e[o].options.elements,n)}(t.elements,l),l.traverse(function(t,e,n){Array.prototype.push.apply(t,i.ANGULAR_REQUIREMENTS.get(n))}.bind(null,r.options.angular_dependencies)),r.options.angular_dependencies=n.arryOperations.unique(r.options.angular_dependencies)},o("AngularPreProcessor",l)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_applib,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent),angular.module("allex_applib",[]),function(t,e,i,n){"use strict";var o=t.lib,r=o.BasicAngularController;function a(t){r.call(this,t),this.raise=null,this._getResource=null}function l(t){a.call(this,t),this.data=null}o.inherit(a,r),a.prototype.__cleanUp=function(){this.raise=null,this._getResource=null,r.prototype.__cleanUp.call(this)},a.prototype.getResource=function(t){return this._getResource?this._getResource(t):void 0},a.prototype.elementReady=function(t){var e=t.data("allex_element");if(!e)throw new Error("Missing allex element ...");e.set("$scopectrl",this)},a.prototype.raiseEvent=function(t,e){this.raise(t,e)},o.inherit(l,a),l.prototype.__cleanUp=function(){this.data=null,a.prototype.__cleanUp.call(this)},l.prototype.set_data=function(t){return this.data!==t&&(this.data=t,!0)},e.elements.AngularDataAwareController=l,e.elements.BasicAngularElementController=a}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n){"use strict";var o=t.lib,r=(o.BasicAngularController,e.elements.WebElement),a=e.mixins.DataElementMixIn;o.q;function l(t,e){r.call(this,t,e),a.call(this),this._addHook("onAngularReady"),this.$scopectrl=null,e&&e.initialData&&this.set("data",e.initialData)}o.inherit(l,r),l.prototype.__cleanUp=function(){this.$scopectrl=null,a.prototype.__cleanUp.call(this),r.prototype.__cleanUp.call(this)},l.prototype.updateHashField=function(t,e){var i={};i[t]=e,this.set("data",o.extend({},this.get("data"),i))},l.prototype.updateArrayElement=function(t,e){var i=this.get("data"),n=i?i.slice():[];n[t]=e,this.set("data",n)},l.prototype.getArrayDataCopy=function(){var t=this.get("data");return t?t.slice():null},l.prototype.getHashDataCopy=function(){return o.extend({},this.get("data"))},l.prototype.set_$scopectrl=function(t){this.$scopectrl=t,this._onScope(t),this._setRaise(),this.fireHook("onAngularReady",[this]),this.$scopectrl.set("data",this.get("data"))},l.prototype.isScopeReady=function(){return!!this.$scopectrl},l.prototype.executeOnScopeIfReady=function(t,e){if(this.$scopectrl){var i=o.readPropertyFromDotDelimitedString(this.$scopectrl,t,!0);return i.val.apply(i.ctx,e)}},l.prototype._setRaise=function(){this.$scopectrl.set("raise",this.raiseEvent.bind(this)),this.$scopectrl.set("_getResource",this.getResource.bind(this))},l.prototype.set_data=function(t){var e=a.prototype.set_data.call(this,t);return a.prototype.hasDataChanged.call(this,e)&&this.executeOnScopeIfReady("set",["data",this.data]),e},l.prototype.getMeAsElement=function(){return this.$element},l.prototype.initialize=function(){r.prototype.initialize.call(this),this.$element.data("allex_element",this),this.attachHook("onAngularReady",this.getConfigVal("onAngularReady"))},l.prototype.$apply=function(){this.$scopectrl&&this.$scopectrl.$apply()},l.prototype._onScope=o.dummyFunc,e.elements.BasicAngularElement=l}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n){"use strict";var o=t.lib,r=e.elements.AngularDataAwareController,a=e.elements.BasicAngularElement;o.q;function l(t,e){a.call(this,t,e)}function s(t,e){a.call(this,t,e)}o.inherit(l,a),l.prototype.__cleanUp=function(){a.prototype.__cleanUp.call(this)},l.prototype.initialize=function(){a.prototype.initialize.call(this),this.$element.attr("data-allex-angular-element","")},e.elements.AngularElement=l,i.registerElementType("AngularElement",l),n.controller("allexAngularElementController",["$scope",function(t){new r(t)}]),n.directive("allexAngularElement",[function(){return{restrict:"A",scope:!0,controller:"allexAngularElementController",link:function(t,e,i){t._ctrl.elementReady(e)}}}]),o.inherit(s,a),s.prototype.set_data=function(t){var e,i,n=a.prototype.set_data.call(this,t);if(!1!==n&&(e=this.__parent.$scopectrl,i=this.$element.attr("name"),e&&i))if(e.data)e.data[i]=t;else{var o={};o[i]=t,e.set("data",o)}return n},e.elements.AngularFormElement=s,i.registerElementType("AngularFormElement",s)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n){"use strict";var o=t.lib,r=e.elements.BasicAngularElementController,a=e.elements.BasicAngularElement,l=(o.q,i.BasicModifier),s=/\[\]$/;function p(t,e){"object"==typeof t&&(o.traverseShallow(t,function(t,e,i){"regex"===i&&(o.isString(e)&&(t[i]=new RegExp(e)),e&&"object"==typeof e&&"string"in e&&"flags"in e&&o.isString(e.string)&&(t[i]=new RegExp(e.string,e.flags)))}.bind(null,t)),t=null)}function c(t,e){var i;a.call(this,t,e),this.$form=null,this.submit=new o.HookCollection,this.partialSubmit=new o.HookCollection,this.valid=null,this._valid_l=null,this.validfields={},this._validfields_l={},this._default_values={},this.change=new o.HookCollection,this.initial=e?e.initial:null,this.ftion_status=null,this.progress=null,this.array_keys=e?e.array_keys:null,(i=this.getConfigVal("validation"))&&(o.traverseShallow(i,p),i=null)}function u(t){r.call(this,t),this.data={},this.valid=!1,this._watcher=null,this.validation=null,this.confirmationfields=null,this._onChange=null,this.config=null,this.progress=null,this.ftion_status=null,this.disabled=!1}function d(t){l.call(this,t)}function h(t){l.call(this,t)}function f(t){return t.ftion}function g(t){l.call(this,t)}o.inherit(c,a),c.prototype.__cleanUp=function(){this.progress=null,this.ftion_status=null,this.array_keys=null,this.initial=null,this.change.destroy(),this.change=null,this._default_values=null,o.traverseShallow(this._validfields_l,this._unlisten.bind(this)),this.validfields=null,this.$form=null,this._valid_l&&this._valid_l.destroy(),this._valid_l=null,this.partialSubmit.destroy(),this.partialSubmit=null,this.submit.destroy(),this.submit=null,this.valid=!1,a.prototype.__cleanUp.call(this)},c.prototype.set_ftion_status=function(t){var e=!1;t&&(this.ftion_status?e=this.ftion_status.working&&t.result:t.result&&(e=!0)),this.ftion_status=t;var i=this.getConfigVal("closeOnSuccess");console.log("was active?",e,i),this.isScopeReady()&&e&&((!0===i||o.isNumber(i))&&this.doCloseOnSuccess(i),this.getConfigVal("clearOnSuccess")&&this.set("data",null)),this.executeOnScopeIfReady("set",["ftion_status",t])},c.prototype.doCloseOnSuccess=function(t){!0===t&&(t=0),this.executeOnScopeIfReady("set",["disabled",!1]),o.runNext(this.set.bind(this,"actual",!1),t)},c.prototype.set_progress=function(t){this.progress=t,this.executeOnScopeIfReady("set",["progress",t])},c.prototype._unlisten=function(t){o.isFunction(t)&&t()},c.prototype.set_actual=function(t){a.prototype.set_actual.call(this,t),this.set("ftion_status",null),this.set("progress",null),this.executeOnScopeIfReady("set",["disabled",!t])},c.prototype.initialize=function(){a.prototype.initialize.call(this),this.$element.attr({"data-allex-angular-form-logic":""}),this.$form=this.$element.is("form")?this.$element:this.$element.find("form"),this.$form.attr({name:this.get("id"),novalidate:""}),this.$form.removeAttr("action"),this.$form.find("[name]").toArray().forEach(this._prepareForAngular.bind(this)),this.appendHiddenFields(this.getConfigVal("hidden_fields"))},c.prototype._prepareForAngular=function(t){var e=jQuery(t),i=e.attr("name"),n=this.getModelName(i);if(n){var o=e.attr("data-ng-readonly"),r=o&&o.length?"("+o+") ||":"";r+="(_ctrl.disabled || _ctrl.progress)",e.attr({"data-allex-angular-validate":"_ctrl.validation."+n,"data-ng-change":"_ctrl.onChange('"+n+"', _ctrl.data."+n+")"}),e.attr("readonly")||e.attr("data-ng-readonly",r),e.attr("data-ng-model")||e.attr("ng-model")||e.attr("data-ng-model","_ctrl.data."+n),this._validfields_l[n]=null}else console.warn("There is no name for input field ",e.attr("id"),"form logic",this.get("id"))},c.prototype.appendHiddenFields=function(t){t&&t.length&&t.forEach(this._appendHiddenField.bind(this))},c.prototype._appendHiddenField=function(t){var e=o.isString(t)?t:t.name,i={name:e,type:"hidden"};!o.isString(t)&&(i.required=t.required?"":void 0,"value"in t&&(this._default_values[e]=t.value)),this.findByFieldName(e).remove();var n=$("<input>").attr(i);this._prepareForAngular(n),this.$form.append(n)},c.prototype.findByFieldName=function(t){return this.$form.find('[name="'+t+'"]')},c.prototype.toArray=function(t){return o.hashToArray(t,this.get("data"))},c.prototype.fireSubmit=function(){this.submit.fire(this.array_keys?this.toArray(this.array_keys):this.get("data"))},c.prototype.firePartialSubmit=function(t){this.isFieldValid(t)&&this.partialSubmit.fire(t,this.data?this.data[t]:null)},c.prototype.set_data=function(t){return o.traverseShallow(this._default_values,function(t,e,i){i in t||(t[i]=e)}.bind(null,t)),a.prototype.set_data.call(this,t)},c.prototype.get_data=function(){return this.$scopectrl?this.$scopectrl.get("data"):this.data},c.prototype.getModelName=function(t){var e=t;return t.match(s)&&(e=t.replace(s,"")),e},c.prototype.revalidate=function(){if(this.$scopectrl){var t=this.$scopectrl.scope[this.id];if(t)for(var e in this.validfields)t[e]&&t[e].$validate()}},c.prototype._onScope=function(t){this._valid_l=t.attachListener("valid",this.set.bind(this,"valid")),t.set("validation",this.getConfigVal("validation")),t.set("confirmationfields",this.getConfigVal("confirmationfields")),t.set("_onChange",this._onChanged.bind(this)),o.traverseShallow(this._validfields_l,this._watchForValid.bind(this,t.scope,this.$form.attr("name"))),t.set("config",this.getConfigVal("form")),t.set("progress",this.get("progress")),t.set("ftion_status",this.get("ftion_status")),t.set("disabled",!this.get("actual")),this.initial&&o.runNext(this._setInitial.bind(this))},c.prototype._onChanged=function(t,e,i){this.changed.fire("data",t),this.change.fire(e,i)},c.prototype._setInitial=function(t){for(var e in this.set("data",o.extend({},this.initial,t)),this.initial)this.change.fire(e,this.initial[e])},c.prototype.resetElement=function(t){a.prototype.resetElement.call(this,t),this.resetForm(t)},c.prototype.resetForm=function(t){this._setInitial(t)},c.prototype._watchForValid=function(t,e,i,n){this._validfields_l[n]=t.$watch("_ctrl.data."+n,this._updateError.bind(this,t,e,n))},c.prototype._updateError=function(t,e,i){var n=o.extend({},this.validfields);t[e][i]?(n[i]=!Object.keys(t[e][i].$error).length,this.set("validfields",n)):console.warn("no "+i+" in validator")},c.prototype.isFieldValid=function(t){return!(!this.$scopectrl||!this.$scopectrl.scope[this.get("id")])&&this.$scopectrl.scope[this.get("id")][t].$valid},c.prototype.set_valid=function(t){return this.valid!==t&&(this.valid=t,!0)},c.prototype.empty=function(){this.set("data",{})},c.prototype.setInputEnabled=function(t,e){var i=this.$form.find('[name="'+t+'"]');i.attr("data-ng-disabled",e?"false":"true"),e?i.removeAttr("disabled"):i.attr("disabled","disabled"),this.executeOnScopeIfReady("$apply")},c.prototype.disableInput=function(t){this.setInputEnabled(t,!1)},c.prototype.enableInput=function(t){this.setInputEnabled(t,!0)},c.prototype.isFormValid=function(){for(var t in this.validfields)if(!this.isFieldValid(t))return!1;return!0},e.elements.AngularFormLogic=c,i.registerElementType("AngularFormLogic",c),o.inherit(u,r),u.prototype.__cleanUp=function(){this.disabled=null,this.ftion_status=null,this.progress=null,this.confirmationfields=null,this.validation=null,this._watcher&&this._watcher(),this._watcher=null,this.data=null,this.valid=null,this._onChange=null,this.config=null,r.prototype.__cleanUp.call(this)},u.prototype.onChange=function(t,e){o.isFunction(this._onChange)&&this._onChange(this.data,t,e)},u.prototype.elementReady=function(t){r.prototype.elementReady.call(this,t),this._watcher=this.scope.$watch(t.attr("id")+".$valid",this.set.bind(this,"valid"))},u.prototype.set_valid=function(t){return this.valid!==t&&(this.valid=t||null,!0)},u.prototype.validate=function(t,e,i){var n=this.validation,r=this.confirmationfields;return!(o.isVal(e)&&r&&"object"==typeof r&&t in r&&e!==this.data[r[t]])&&(!n||(!n[t]||!!this.validateJSON(n[t].json_schema,e)&&(!!this.validateRegExp(n[t].regex,e)&&this.validateFunction(n[t].custom,e))))},u.prototype.validateJSON=function(t,e){return!t||!o.jsonschema.validate(e,t).errors.length},u.prototype.validateRegExp=function(t,e){return!t||(!(t instanceof RegExp)||t.test(e))},u.prototype.validateFunction=function(t,e){return!o.isFunction(t)||t(e,this.data)},n.controller("allexAngularFormLogicController",["$scope",function(t){new u(t)}]),n.directive("allexAngularFormLogic",function(){return{restrict:"A",scope:!0,controller:"allexAngularFormLogicController",link:function(t,e,i){t._ctrl.elementReady(e)}}}),o.inherit(d,l),d.prototype.destroy=function(){l.prototype.destroy.call(this)},d.prototype.doProcess=function(t,e,i,n,o){var r=t+"Submit",a="."+r;switch(e.elements.push({name:r,type:"WebElement"}),i.push({source:a+".$element!click",target:".>fireSubmit"},{source:".:valid",target:"$element.#"+r+":attr.disabled",filter:this._decideDisabled.bind(this)}),this.getConfigVal("actual")){case"always":i.push({source:".:actual",target:a+":actual"});break;default:case"valid":n.push({triggers:[".:valid, .:actual"],references:a+", .",handler:function(t,e){t.set("actual",e.get("valid")&&e.get("actual"))}})}},d.prototype._decideDisabled=function(t){return t?void 0:"disabled"},d.ALLOWED_ON=["AngularFormLogic"],d.prototype.DEFAULT_CONFIG=function(){return{actualon:"valid"}},i.registerModifier("AngularFormLogic.submit",d),o.inherit(h,l),h.prototype.destroy=function(){l.prototype.destroy.call(this)},h.prototype.doProcess=function(t,e,i,n,o){var r=this.getConfigVal("form"),a=this.getConfigVal("cbs");if(!r)throw new Error("No form in SubmissionModifier");if(!a)throw new Error("No cbs in SubmissionModifier");n.push({triggers:r+"!submit",references:[r].concat(a.map(f)).join(","),handler:this._onSubmit.bind(this,a)});for(var l=r+":progress",s=r+":ftion_status",p=0;p<a.length;p++)i.push({source:a[p].ftion,target:l,filter:this._processProgress.bind(this)},{source:a[p].ftion,target:s,filter:this._processStatus.bind(this)})},h.prototype._onSubmit=function(t,e){for(var i=t.length,n=Array.prototype.slice.call(arguments,2,t.length+2),r=arguments[2+t.length],a=0;a<i;a++)t[a].conditional&&!t[a].conditional(r)||n[a](o.isFunction(t[a].filter)?t[a].filter(r,e):[r])},h.prototype._processFilter=function(t){},h.prototype._processProgress=function(t){return t&&t.working&&t.progress},h.prototype._processStatus=function(t){return!t||t.working?null:t.error?{error:t.error}:t.result?{result:t.result}:null},h.prototype.DEFAULT_CONFIG=function(){return null},i.registerModifier("SubmissionModifier",h),o.inherit(g,l),g.prototype.destroy=function(){l.prototype.destroy.call(this)},g.ALLOWED_ON=["AngularFormLogic"],g.prototype._prepareItem=function(t,e,i,n,o,r){var a=r.path,l=r.field;if(!l)throw new Error("No field given in FieldBindingModifier "+t);a||(a=t+"_partialSubmit_"+l),i.push({source:".:actual",target:a+":actual"}),n.push({triggers:[".:actual",".:data"],references:"., "+a,handler:this._decide.bind(this,l)},{triggers:a+".$element!click",references:".",handler:this._onTrigger.bind(this,l)})},g.prototype.doProcess=function(t,e,i,n,r){var a=this.getConfigVal("list");if(o.isArray(a))a.forEach(this._prepareItem.bind(this,t,e,i,n,r));else{var l=this.getConfigVal("path"),s=this.getConfigVal("field");s&&this._prepareItem(t,e,i,n,r,{path:l,field:s})}},g.prototype._decide=function(t,e,i){i.$element.attr("disabled",e.isFieldValid(t)?null:"disabled")},g.prototype._onTrigger=function(t,e){e.firePartialSubmit(t)},g.prototype.DEFAULT_CONFIG=function(){return null},i.registerModifier("AngularFormLogic.bindField",g)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n){"use strict";var o=t.lib,r=e.elements.AngularDataAwareController,a=(e.mixins.DataElementMixIn,e.elements.BasicAngularElement),l=o.CBMapable;o.q;function s(t,e){"headerCellFilter"in e||(e.headerCellFilter=t)}function p(t,e){a.call(this,t,e),this.afterEdit=new o.HookCollection,this.config.grid=o.extend({},p.DEFAULT_GRID_CONFIG,this.config.grid),this.config.grid.data||(this.config.grid.data="_ctrl.data"),this.config.defaultHeaderCellFilter&&this.config.grid.columnDefs.forEach(s.bind(null,this.config.defaultHeaderCellFilter))}function c(t){return d("enableCellEdit",t)}function u(t){return d("enableColumnResizing",t)}function d(t,e){if(e[t])return!0}function h(t,e){t[e]&&"#"===t[e].charAt(0)&&(t[e]=jQuery("#references > "+t[e]).html())}function f(t,e){e.type&&(e.type=t[e.type]),e.condition&&o.isString(e.condition)&&(e.condition=t[e.condition])}function g(t,e,i){r.call(this,t),l.call(this),this.uiGridConstants=i,this.data=[],this.gridOptions=null,this.api=null,this._listenToEditEvents=!1}o.inherit(p,a),p.prototype.__cleanUp=function(){this.afterEdit.destroy(),this.afterEdit=null,a.prototype.__cleanUp.call(this)},p.prototype._replacePossibleTemplates=function(t){h(t,"cellTemplate"),h(t,"filterHeaderTemplate")},p.prototype.initialize=function(){a.prototype.initialize.call(this);var t=this.config.grid.enableCellEdit||o.traverseConditionally(this.getColumnDefs(),c),e=this.config.grid.enableColumnResizing||o.traverseConditionally(this.getColumnDefs(),u),i=this.getConfigVal("noDataContent"),n=this.getConfigVal("grid.data");this.getColumnDefs().forEach(this._replacePossibleTemplates.bind(this));var r=$('<div class="table_container" ng-show="'+n+'.length"></div>'),l=$('<div class="no_data_container" ng-show = "!'+n+'.length"></div>');r.attr("ui-grid","_ctrl.gridOptions"),r.attr("ui-grid-auto-resize",""),t&&r.attr("ui-grid-edit",""),e&&r.attr("ui-grid-resize-columns",""),o.isString(i)&&("#"===i[0]?l.append($("#references > "+i).html()):l.append(i)),!0===i&&l.append(this.findDomReference("nodata").html()),r.addClass("grid"),this.$element.attr({"data-allex-angular-data-table":""}),this.$element.append(r),i&&this.$element.append(l);var p=this.findDomReference("actions"),d=null,h=this.getConfigVal("actionsWrapper")?$(this.getConfigVal("actionsWrapper")):null,f=h?$(h):null;if(d=f?p.length?f.append(p):null:p.length?p:null){var g,_,m=o.arryOperations.findElementWithProperty(this.config.grid.columnDefs,"field","-"),y={displayName:d.attr("data-title")||"Actions",cellTemplate:d.html()};m?(m.displayName||(m.displayName=y.displayName),m.cellTemplate||(m.cellTemplate=y.cellTemplate)):this.config.grid.columnDefs.unshift(o.extend({},y,(g=this.config,_=o.extend({},g.actions,{field:"-",enableFiltering:!1}),s(g.defaultHeaderCellFilter,_),_)))}},p.prototype.getApi=function(){return this.$scopectrl?this.$scopectrl.api:null},p.prototype._onScope=function(t){var e={appendNewRow:this.appendNewRow.bind(this)};""===this.$element.find(".grid.table_container").attr("ui-grid-edit")&&(e.afterEdit=this.afterEdit.fire.bind(this.afterEdit)),t.set("_cbmap",e),this.config.grid.enableHorizontalScrollbar=!1===this.config.grid.enableHorizontalScrollbar?t.uiGridConstants.scrollbars.NEVER:t.uiGridConstants.scrollbars.ALWAYS,this.config.grid.enableVerticalScrollbar=!1===this.config.grid.enableVerticalScrollbar?t.uiGridConstants.scrollbars.NEVER:t.uiGridConstants.scrollbars.ALWAYS,this.config.grid.columnDefs.forEach(this._processFilters.bind(this,t)),t.set("gridOptions",this.config.grid)},p.prototype._processFilters=function(t,e,i){var n=t.uiGridConstants.filter;if(e.filter)return f(n,e.filter),e.filters=[e.filter],void(e.filter=null);e.filters&&e.filters.forEach(f.bind(null,n))},p.prototype.set_data=function(t){!1!==a.prototype.set_data.call(this,t)&&(this.executeOnScopeIfReady("set",["data",t]),this.executeOnScopeIfReady("api.core.refresh"))},p.prototype.getCleanData=function(){angular.copy(this.getTableData())},p.prototype.appendNewRow=function(t){var e={};this.getConfigVal("config.bSetNewRowProps");var i=this.getConfigVal("appendNewRow");return i?i(this,t,e):e},p.prototype.get_rows=function(){return this.$scopectrl.api?this.$scopectrl.api.grid.rows:null},p.prototype.getElement=function(t){return"$element"===t?this.$element:a.prototype.getElement.call(this,t)},p.prototype.set_row_count=function(t){return this.executeOnScopeIfReady("set",["row_count",t])},p.prototype.get_row_count=function(){return this.executeOnScopeIfReady("get",["row_count"])},p.prototype.getColumnDefs=function(){return this.getConfigVal("grid.columnDefs")},p.prototype.$apply=function(){a.prototype.$apply.call(this),this.executeOnScopeIfReady("api.core.refresh")},p.prototype.removeAllColumns=function(){if(this.isScopeReady())this.config.grid.columnDefs.splice(0,this.config.grid.columnDefs.length),this.refreshGrid();else{var t=this.getColumnDefs();t.splice(0,t.length)}},p.prototype.appendColumn=function(t){this.isScopeReady()?(this.config.grid.columnDefs.push(t),this.refreshGrid()):this.getColumnDefs().push(t)},p.prototype.set_column_defs=function(t){if(this.isScopeReady())this.config.grid.columnDefs=t,this.refreshGrid();else{var e=this.getColumnDefs();e.splice(0,e.length),Array.prototype.push.apply(e,t)}},p.prototype.updateColumnDef=function(t,e){if(this.isScopeReady())return this.getColumnDef(t).colDef=e,void this.refreshGrid();var i=this.getColumnDef(t),n=this.getColumnDefs(),o=n.indexOf(i);if(o<0)throw new Error("No column definition for name ",t);n[o]=e},p.prototype.getColumnDef=function(t){if(this.isScopeReady()&&this.getApi().grid.columns.length){var e=this.getApi().grid.getColumn(t);return e?e.colDef:null}return o.arryOperations.findElementWithProperty(this.getColumnDefs(),"name",t)},p.prototype.refreshGrid=function(){this.executeOnScopeIfReady("api.grid.refresh")},p.prototype.getTableData=function(){return this.executeOnScopeIfReady("getActualData")},p.prototype.getRowIndexUponEntity=function(t){for(var e=this.getApi().grid.rows,i=0;i<e.length;i++)if(e[i].entity.$$hashKey===t.$$hashKey)return i;return-1},p.prototype.removeRow=function(t){var e=this.getTableData(),i=this.getRowIndexUponEntity(t);i<0||(e.splice(i,1),this.refreshGrid())},p.isSpecialColumnName=function(t){return"-"===t},p.DEFAULT_GRID_CONFIG=null,e.elements.AngularDataTable=p,i.registerElementType("AngularDataTable",p),e.ANGULAR_REQUIREMENTS.add("AngularDataTable",["ui.grid","ui.grid.edit","ui.grid.autoResize","ui.grid.resizeColumns"]),o.inherit(g,r),l.addMethods(g),g.prototype.__cleanUp=function(){this.uiGridConstants=null,this.rowCountChanged.destroy(),this.rowCountChanged=null,this.editDone=new o.HookCollection,this.gridOptions=null,this.data=null,this.api=null,l.prototype.__cleanUp.call(this),r.prototype.__cleanUp.call(this)},g.prototype.set_gridOptions=function(t){return this.gridOptions!==t&&(this.api=null,this.gridOptions=t,!this.gridOptions||void(this.gridOptions.onRegisterApi=this.set.bind(this,"api")))},g.prototype.set_api=function(t){this.api!==t&&(this.api=t,this._cbmap&&this._cbmap.afterEdit&&this.api.edit.on.afterCellEdit(this.scope,this._onAfterEdit.bind(this)))},g.prototype._onAfterEdit=function(t,e,i,n){n!==i&&this.call_cb("afterEdit",[{newValue:i,oldValue:n,row:t,field:e.name}])},g.prototype.set_row_count=function(t){var e=this.getActualData();if(!o.isArray(e))return!1;var i=e.length,n=null;if(t===i)return!1;if(t<i)e.splice(t,i-t);else for(;e.length<t;)n=this.call_cb("appendNewRow",[e.length]),e.push(n);return!0},g.prototype.getActualData=function(){return o.isString(this.gridOptions.data)?this.scope.$eval(this.gridOptions.data):this.gridOptions.data},g.prototype.get_row_count=function(){return this.getActualData().length},n.controller("allexAngularDataTableController",["$scope","$parse","uiGridConstants",function(t,e,i){new g(t,e,i)}]),n.directive("allexAngularDataTable",[function(){return{restrict:"A",scope:!0,controller:"allexAngularDataTableController",link:function(t,e,i){t._ctrl.elementReady(e)}}}])}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n){"use strict";var o=t.lib,r=e.elements.BasicAngularElementController,a=e.elements.BasicAngularElement,l=(o.q,i.BasicModifier);function s(t,e){a.call(this,t,e),this.data=null,this._temp_cache=null}function p(t,e){r.call(this,t),this.$templateCache=e,this.content_container=null,this.html=null,this.data=null,this.title=null,this.notificationClass=null}function c(t){l.call(this,t)}o.inherit(s,a),s.prototype.__cleanUp=function(){this._temp_cache&&this._temp_cache.destroy(),this._temp_cache=null,this.data=null,a.prototype.__cleanUp.call(this)},s.prototype._processToCache=function(t,e){var i=$(e).attr("id");i.match(t)&&!this.isDefaultTemplate(i)&&(this._addToCache(e,i),$(e).remove())},s.prototype._addToCache=function(t,e){if(0===t.length)throw new Error("Unable to find item "+e);e||(e=$(t).attr("id")),this._temp_cache||(this._temp_cache=new o.Map),this._temp_cache.add(e,$(t).html())},s.prototype.isDefaultTemplate=function(t){var e=this.getConfigVal("defaultTemplate");return!!e&&(t===e.error||t===e.success||t===e.progress)},s.prototype.initialize=function(){a.prototype.initialize.call(this);var t=new RegExp("^angular_notification_"+this.get("id"));$("#references").children().toArray().forEach(this._processToCache.bind(this,t));var e=this.getConfigVal("defaultTemplate");e&&(e.error&&this._addToCache($("#references #"+e.error)),e.success&&this._addToCache($("#references #"+e.success)),e.progress&&this._addToCache($("#references #"+e.progress))),this.$element.attr({"allex-notification":""}),this.$element.find(this.getConfigVal("contentSelector")).attr("data-ng-include","_ctrl.html")},s.prototype.set_actual=function(t){a.prototype.set_actual.call(this,t);var e=this.getConfigVal("setActual");o.isFunction(e)&&e(this.$element,t)},s.prototype.templateName=function(t){return"#references #angular_notification_"+this.get("id")+"_"+t},s.prototype.findTemplate=function(t){var e=$(this.templateName(t));return e.length?e:null},s.prototype.set_data=function(t){if(this.data===t)return!1;if(this.data=t,this.data){var e=this.templateName(t.name);if(!this.$scopectrl.$templateCache.get(this.templateName(t.name))){if(!(e=this.getConfigVal("defaultTemplate")?this.getConfigVal("defaultTemplate")[t.type]:null))return;e="#references #"+e}this.$scopectrl.html=e,this.$scopectrl.notificationClass=t.notificationClass||null,this.$scopectrl.title=t.title||null,this.$scopectrl.set("data",t.content_data),this.set("actual",!0)}else this._doHide()},s.prototype._doHide=function(){this.$scopectrl.set("data",null),this.set("actual",!1)},s.prototype.set_ftion=function(t){if(t&&(t.data.error||t.data.progress||t.data.result)){var e=null,i=this.getConfigVal("functionConfigs"),n=null,o=null,r=null,a=null;if(t.data.error)r=t.data.error,o=t.name+"_error",n=this.getConfigVal("defaultErrorTitle"),a="error";else if(t.data.result)r=t.data.result,o=t.name+"_success",n=this.getConfigVal("defaultSuccessTitle"),a="success";else if(t.data.progress&&(r=t.data.progress,o=t.name+"_progress",n=this.getConfigVal("defaultProgressTitle"),a="progress",!t.data.running))return void console.log("got progress, but not running",t);i&&i[o]&&(e=i.notificationClass,n=i.title),e=(e||"")+" "+a,this.set("data",{name:o,content_data:r,notificationClass:e,title:n,type:a})}},s.prototype._onScope=function(t){this._temp_cache&&(this._temp_cache.traverse(function(t,e,i){t.$scopectrl.$templateCache.put("#references #"+i,e)}.bind(null,this)),this._temp_cache.destroy(),this._temp_cache=null)},e.elements.AngularNotification=s,i.registerElementType("AngularNotification",s),o.inherit(p,r),p.prototype.__cleanUp=function(){this.content_container=null,this.html=null,this.$templateCache=null,this.title=null,this.notificationClass=null,this.data=null,r.prototype.__cleanUp.call(this)},p.prototype.set_content_container=function(t){this.content_container=t},n.controller("allexNotificationController",["$scope","$templateCache",function(t,e){new p(t,e)}]),n.directive("allexNotification",[function(){return{restrict:"A",scope:!0,controller:"allexNotificationController",link:function(t,e){t._ctrl.elementReady(e)}}}]),o.inherit(c,l),c.prototype.destroy=function(){l.prototype.destroy.call(this)},c.prototype.doProcess=function(t,e,i,n,o){e.contentSelector||(e.contentSelector=".modal-body"),this.hookToArray(e,"onActual",this._onActual.bind(this)),this.hookToArray(e,"onInitialized",this._onIntialized.bind(this))},c.prototype._onActual=function(t,e){t.$element.modal(e?"show":"hide")},c.prototype._onIntialized=function(t){t.$element.on("shown.bs.modal",t.set.bind(t,"actual",!0)),t.$element.on("hidden.bs.modal",t.set.bind(t,"actual",!1))},c.prototype.ALLOWED_ON=["AngularNotification","AngularFormLogic"],c.prototype.DEFAULT_CONFIG=function(){return null},i.registerModifier("AngularElements.BootstrapModal",c)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular.module("allex_applib")),function(t,e,i,n,o){"use strict";var r=t.lib,a=i.BasicResourceLoader,l=r.q;function s(t,e){a.call(this,r.extend({},t,{ispermanent:!0})),this._dependentElements=new r.Map,e.onReady(this._onReady.bind(this))}r.inherit(s,a),s.prototype.__cleanUp=function(){this._dependentElements.destroy(),this._dependentElements=null,a.prototype.__cleanUp.call(this)},s.prototype.doLoad=function(){var t=l.defer();return t.resolve("ok"),t},s.prototype._onReady=function(t){var i=this.getConfigVal("angular_dependencies");i?(i.indexOf("allex_applib")<0&&i.push("allex_applib"),i.indexOf("allex__web_angularcomponent")<0&&i.push("allex__web_angularcomponent")):i=["allex_applib"],e.ANGULAR_REQUIREMENTS.traverse(function(t,e){var i=r.arryOperations.difference(e,t);Array.prototype.push.apply(t,i)}.bind(null,i)),n.module("AllexActiveApp",i),n.module("AllexActiveApp").run(this._onModuleStarted.bind(this)),n.bootstrap(document,["AllexActiveApp"])},s.prototype._onModuleStarted=function(){var t=this.getConfigVal("onBootstrapped");r.isFunction(t)&&t(),t=window.AllexAngularBootstrapped,r.isFunction(t)&&t()},s.prototype.DEFAULT_CONFIG=function(){return{angular_dependencies:["allex_applib"]}},s.prototype.registerDependentElement=function(t){this._dependentElements.add(t.get("id"))},s.prototype.dependentElementReady=function(t){this._dependentElements.remove(t.get("id"))},e.resources.AngularBootstrapper=s,i.registerResourceType("AngularBootstrapper",s)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,angular,jQuery),function(t,e,i,n){"use strict";var o=t.lib,r=(i.BasicElement,i.BasicModifier,i.BasicProcessor);e.misc.RouterMixIn,i.misc,o.q;function a(){r.call(this)}function l(t,e){return{name:t,data:e}}o.inherit(a,r),a.prototype.process=function(t){for(var e in this.config)this.createNotificationElement(e,this.config[e],t)},a.prototype.createNotificationElement=function(t,e,i){for(var n,o=0;o<e.length;o++)n=e[o],i.links.push({source:".>"+n,target:t+":ftion",filter:l.bind(null,n)})},i.registerPreprocessor("Notificator",a)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,jQuery),function(t,e,i,n){"use strict";var o=t.lib,r=i.BasicModifier,a=e.elements.AngularDataTable;function l(t){this.modifier=t}function s(t){r.call(this,t)}l.prototype.destroy=function(){this.modifier=null},l.prototype.isEmpty=function(t){return modifier.isEmpty(t)},o.inherit(s,r),s.prototype.destroy=function(){r.prototype.destroy.call(this)},s.prototype.ALLOWED_ON=function(){return"AngularDataTable"},s.prototype.DEFAULT_CONFIG=function(){return{eventName:"removeRow",isEmpty:function(t){for(var e in t)if(o.isVal(t[e]))return!1;return!0},isFull:function(t){for(var e in t)if(!o.isVal(t[e]))return!1;return!0}}},s.prototype._addNewRow=function(t){var e,i,n={};for(var o in t.grid.columnDefs)i=(e=t.grid.columnDefs[o]).field||e.name,a.isSpecialColumnName(i)||(n[i]=null);return n},s.prototype.doProcess=function(t,e,i,n,r){var a=this.getConfigVal("eventName");if(this.getConfigVal("newRow")||this.setConfigVal("newRow",this._addNewRow.bind(this,e),!0),!o.isFunction(this.getConfigVal("newRow")))throw new Error("newRow is not a function");if(!o.isFunction(this.getConfigVal("isEmpty")))throw new Error("isEmptyRow must be a function");if(!o.isFunction(this.getConfigVal("isFull")))throw new Error("isFull must be a function");e.appendNewRow=this.getConfigVal("newRow"),e.helperObj||(e.helperObj={}),e.helperObj.autoappend=new l(this);var s=[{triggers:".!afterEdit",references:".",handler:this._onAfterEdit.bind(this,this.getConfigVal("isEmpty"),this.getConfigVal("isFull"))},{triggers:".$element!"+a,references:".",handler:this._onRemoveRequested.bind(this)},{triggers:".:data",references:".",handler:this._onData.bind(this,this.getConfigVal("isEmpty"),this.getConfigVal("isFull"))}];Array.prototype.push.apply(n,s)},s.prototype._onData=function(t,e,i,n){o.isNull(n)||this._doAppend(t,e,i)},s.prototype.isEmptyRow=function(t,e){return e(t)},s.prototype._doAppend=function(t,e,i){var n=i.getTableData(),o=n[n.length-1];0!==n.length?!t(o)&&e(o)&&i.set("row_count",i.get("row_count")+1):i.set("row_count",1)},s.prototype._onAfterEdit=function(t,e,i,n){n.row&&e(n.row)&&this._doAppend(t,e,i)},s.prototype._onRemoveRequested=function(t,e,i){t.removeRow(i)},i.registerModifier("AngularDataTableAutoAppendRow",s)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,jQuery),function(t,e,i,n){"use strict";var o=t.lib,r=i.BasicModifier,a=i.misc;function l(t){r.call(this,t)}function s(t){r.call(this,t)}o.inherit(l,r),l.prototype.ALLOWED_ON=function(){return"AngularFormLogic"},l.prototype.DEFAULT_CONFIG=function(){return null},l.prototype.doProcess=function(t,e,i,n,o){a.addHook(e,"onInitialized",this._onInitialized.bind(this,this.config))},l.prototype._onInitialized=function(t,e){var i=e.$element,n=i.find(t.from),r=i.find(t.to),a=o.extend({},t.options),l=o.extend({},t.options);a.maxDate=moment(),l.maxDate=moment(),t.maxDateOffset&&(a.maxDate.add.apply(a.maxDate,t.maxDateOffset),l.maxDate.add.apply(l.maxDate,t.maxDateOffset)),n.datetimepicker(a),r.datetimepicker(l),n.on("dp.change",this._onFromChanged.bind(this,t,e,r,n)),r.on("dp.change",this._onToChanged.bind(this,t,e,r,n)),r.on("dp.show",this._onToShowEvent.bind(this,t,e,r,n)),n.on("dp.show",this._onFromShowEvent.bind(this,t,e,r,n))},l.prototype._onFromShowEvent=function(t,e,i,n,o){var r=n.data("DateTimePicker").date();this._onFromChanged(t,e,i,n,{date:r})},l.prototype._onToShowEvent=function(t,e,i,n,o){var r=moment();t.maxDateOffset&&(r=r.add.apply(r,t.maxDateOffset)),i.data("DateTimePicker").maxDate(r);var a=i.data("DateTimePicker").date();this._onToChanged(t,e,i,n,{date:a})},l.prototype._onToChanged=function(t,e,i,n,o){var r=o.date?o.date.format(t.options.format):null;e.updateHashField(i.attr("name"),r),n.data("DateTimePicker").maxDate(r?moment(r,t.options.format):moment())},l.prototype._onFromChanged=function(t,e,i,n,o){e.updateHashField(n.attr("name"),o.date?o.date.format(t.options.format):null)},i.registerModifier("TimeInterval",l),o.inherit(s,r),s.prototype.DEFAULT_CONFIG=function(){return null},s.prototype.ALLOWED_ON=function(){return"AngularFormLogic"},s.prototype.doProcess=function(t,e,i,n,o){n.push({triggers:"."+this.getConfigVal("trigger")+".$element!click",references:".",handler:this._onResetRequested.bind(this,this.config)})},s.prototype._onResetRequested=function(t,e){t.elements.forEach(this._resetOnField.bind(this,e))},s.prototype._resetOnField=function(t,e){var i=t.$element.find(e),n=i.attr("name");t.updateHashField(n,null),i.datetimepicker("clear")},i.registerModifier("TimeIntervalReset",s)}(ALLEX,ALLEX.WEB_COMPONENTS.allex_web_webappcomponent,ALLEX.WEB_COMPONENTS.allex_applib,jQuery);